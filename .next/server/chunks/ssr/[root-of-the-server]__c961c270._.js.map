{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 212, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI/B,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,8OAAC,qKAAA,CAAA,OAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG,qKAAA,CAAA,OAAuB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/tooltip.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,kBAAkB,mKAAA,CAAA,WAAyB;AAEjD,MAAM,UAAU,mKAAA,CAAA,OAAqB;AAErC,MAAM,iBAAiB,mKAAA,CAAA,UAAwB;AAE/C,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC1C,8OAAC,mKAAA,CAAA,UAAwB;QACvB,KAAK;QACL,YAAY;QACZ,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sYACA;QAED,GAAG,KAAK;;;;;;AAGb,eAAe,WAAW,GAAG,mKAAA,CAAA,UAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/game-data.ts"],"sourcesContent":["\nexport type CardData = {\n    id: string;\n    name: string;\n    description: string;\n    manaCost: number;\n    attack: number;\n    defense: number;\n    healing: number;\n    class: string;\n};\n\nexport const CARD_DATA: Record<string, Omit<CardData, 'id' | 'class'>> = {\n    \"Backstab\": { name: \"Backstab\", description: \"A swift, high-damage attack.\", manaCost: 2, attack: 10, defense: 0, healing: 0 },\n    \"Silent But Deadly\": { name: \"Silent But Deadly\", description: \"A moderate attack that ignores some defense.\", manaCost: 3, attack: 5, defense: 0, healing: 0 },\n    \"Smoke Bomb\": { name: \"Smoke Bomb\", description: \"Gain a small amount of defense.\", manaCost: 1, attack: 0, defense: 5, healing: 0 },\n    \"Basic Attack\": { name: \"Basic Attack\", description: \"A simple, low-cost attack.\", manaCost: 1, attack: 3, defense: 0, healing: 0 },\n    \"Smell the Truth\": { name: \"Smell the Truth\", description: \"A weak attack that reveals enemy weaknesses.\", manaCost: 3, attack: 2, defense: 0, healing: 0 },\n    \"Holy Shield\": { name: \"Holy Shield\", description: \"Greatly increases your defense for one turn.\", manaCost: 2, attack: 0, defense: 15, healing: 0 },\n    \"Purify\": { name: \"Purify\", description: \"Heal yourself for a small amount.\", manaCost: 2, attack: 0, defense: 0, healing: 8 },\n    \"Gas Cloud\": { name: \"Gas Cloud\", description: \"A potent area-of-effect attack.\", manaCost: 4, attack: 8, defense: 0, healing: 0 },\n    \"Chain Lightning Farts\": { name: \"Chain Lightning Farts\", description: \"Powerful magic that strikes multiple foes.\", manaCost: 5, attack: 12, defense: 0, healing: 0 },\n    \"Arcane Missile\": { name: \"Arcane Missile\", description: \"A reliable magic attack.\", manaCost: 2, attack: 5, defense: 0, healing: 0 },\n    \"Bean Rage\": { name: \"Bean Rage\", description: \"A furious, high-damage attack.\", manaCost: 3, attack: 15, defense: 0, healing: 0 },\n    \"Mighty Cleave\": { name: \"Mighty Cleave\", description: \"A strong swing that can hit adjacent enemies.\", manaCost: 2, attack: 7, defense: 0, healing: 0 },\n    \"Unstoppable Charge\": { name: \"Unstoppable Charge\", description: \"A powerful charge that breaks defenses.\", manaCost: 4, attack: 10, defense: 0, healing: 0 },\n    \"Aroma Heal\": { name: \"Aroma Heal\", description: \"A powerful healing spell.\", manaCost: 3, attack: 0, defense: 0, healing: 20 },\n    \"Blessing of Freshness\": { name: \"Blessing of Freshness\", description: \"Gain a significant amount of defense.\", manaCost: 2, attack: 0, defense: 10, healing: 0 },\n    \"Resurrection\": { name: \"Resurrection\", description: \"Revive a fallen ally (or yourself).\", manaCost: 8, attack: 0, defense: 0, healing: 50 },\n    \"Basic Smite\": { name: \"Basic Smite\", description: \"A minor holy attack.\", manaCost: 1, attack: 2, defense: 0, healing: 0 },\n    \"Hostile Takeover\": { name: \"Hostile Takeover\", description: \"Weaken an enemy and steal their strength.\", manaCost: 4, attack: 5, defense: 0, healing: 0 },\n    \"Corporate Merger\": { name: \"Corporate Merger\", description: \"Combine two cards for a stronger effect.\", manaCost: 5, attack: 0, defense: 0, healing: 0 },\n    \"Invest\": { name: \"Invest\", description: \"Sacrifice your turn to gain more mana next turn.\", manaCost: 1, attack: 0, defense: 0, healing: 0 },\n};\n\n\nexport type CharacterClass = {\n  id: string;\n  name: string;\n  image: string;\n  imageHint: string;\n  attributes: {\n    strengths: string[];\n    weaknesses: string[];\n  };\n  stats: {\n    attack: number;\n    defense: number;\n    speed: number;\n  };\n  specialTraits: string[];\n  starterDeck: { name: string; count: number }[];\n  weaknessesToKnow: string[];\n  signatureCard: string;\n  specialAbility: string;\n  playstyle: string;\n};\n\nexport const CLASSES: CharacterClass[] = [\n  {\n    id: \"rogue\",\n    name: \"Sneaky Rogue\",\n    image: \"https://storage.googleapis.com/character_poot/ch1.png\",\n    imageHint: \"rogue assassin\",\n    attributes: {\n      strengths: [\"Stealth +90%\", \"Critical Hit +75%\", \"Speed +80%\"],\n      weaknesses: [\"Defense -60%\", \"HP -40%\", \"Area Damage -70%\"],\n    },\n    stats: { attack: 80, defense: 30, speed: 70 },\n    specialTraits: [\"Stealth Master\", \"Critical Strike Expert\", \"Glass Cannon (Fragile)\"],\n    starterDeck: [\n      { name: \"Silent But Deadly\", count: 3 },\n      { name: \"Backstab\", count: 2 },\n      { name: \"Smoke Bomb\", count: 2 },\n      { name: \"Basic Attack\", count: 8 },\n    ],\n    weaknessesToKnow: [\"Low health pool - avoid direct hits\", \"Poor against groups\", \"Relies on positioning\"],\n    signatureCard: \"Silent But Deadly (Invisible poison DOT)\",\n    specialAbility: \"Phase through enemies once per battle\",\n    playstyle: \"Hit-and-run, single-target assassinations\",\n  },\n  {\n    id: \"paladin\",\n    name: \"Paladin of Purity\",\n    image: \"https://storage.googleapis.com/character_poot/homie.jpg\",\n    imageHint: \"armored knight\",\n    attributes: {\n      strengths: [\"Defense +85%\", \"Healing +90%\", \"Debuff Resistance +100%\"],\n      weaknesses: [\"Damage -50%\", \"Speed -45%\", \"Mana Regen -30%\"],\n    },\n    stats: { attack: 40, defense: 90, speed: 20 },\n    specialTraits: [\"Ultimate Tank\", \"Party Healer\", \"Debuff Immune\"],\n    starterDeck: [\n        { name: \"Smell the Truth\", count: 3 },\n        { name: \"Holy Shield\", count: 2 },\n        { name: \"Purify\", count: 2 },\n        { name: \"Basic Attack\", count: 8 },\n    ],\n    weaknessesToKnow: [\"Very low damage output\", \"Slow and ponderous\", \"Reliant on party members\"],\n    signatureCard: \"Smell the Truth (Reveals enemy weakness, heals party)\",\n    specialAbility: \"Divine Shield absorbs 3 attacks\",\n    playstyle: \"Tank/support, slow but unbreakable\",\n  },\n  {\n    id: \"wizard\",\n    name: \"Goddess of Wind\",\n    image: \"https://storage.googleapis.com/character_poot/sista.jpg\",\n    imageHint: \"wind goddess\",\n    attributes: {\n      strengths: [\"AOE Damage +95%\", \"Elemental Mastery +85%\", \"Mana +100%\"],\n      weaknesses: [\"Physical Defense -65%\", \"HP -55%\", \"Chaos Risk +40%\"],\n    },\n    stats: { attack: 95, defense: 20, speed: 50 },\n    specialTraits: [\"AOE Specialist\", \"Master of Elements\", \"High Risk / High Reward\"],\n    starterDeck: [\n        { name: \"Gas Cloud\", count: 3 },\n        { name: \"Chain Lightning Farts\", count: 2 },\n        { name: \"Arcane Missile\", count: 2 },\n        { name: \"Basic Attack\", count: 8 },\n    ],\n    weaknessesToKnow: [\"Extremely fragile\", \"Can miscast spells, causing self-damage\", \"Vulnerable to silence\"],\n    signatureCard: \"Gas Cloud (Damages all enemies + confusion)\",\n    specialAbility: \"Chain Lightning Farts (bounces between enemies)\",\n    playstyle: \"Glass cannon, elemental combos\",\n  },\n  // {\n  //   id: \"barbarian\",\n  //   name: \"Barbarian of Beans\",\n  //   image: \"/images/barbarian.png\",\n  //   imageHint: \"muscular warrior\",\n  //   attributes: {\n  //     strengths: [\"Melee Damage +100%\", \"HP +90%\", \"Knockback +80%\"],\n  //     weaknesses: [\"Accuracy -50%\", \"Magic Resist -60%\", \"Control -70%\"],\n  //   },\n  //   stats: { attack: 100, defense: 50, speed: 40 },\n  //   specialTraits: [\"Pure Damage\", \"High Health Pool\", \"Uncontrollable Rage\"],\n  //   starterDeck: [\n  //       { name: \"Bean Rage\", count: 3 },\n  //       { name: \"Mighty Cleave\", count: 2 },\n  //       { name: \"Unstoppable Charge\", count: 2 },\n  //       { name: \"Basic Attack\", count: 8 },\n  //   ],\n  //   weaknessesToKnow: [\"Attacks can miss frequently\", \"Vulnerable to magic\", \"May attack allies in rage mode\"],\n  //   signatureCard: \"Bean Rage (Massive AOE, self-damage over time)\",\n  //   specialAbility: \"Unstoppable Charge (breaks through defenses)\",\n  //   playstyle: \"Berserk aggro, high-risk/reward\",\n  // },\n  // {\n  //   id: \"cleric\",\n  //   name: \"Cleric of Febreze\",\n  //   image: \"/images/cleric.png\",\n  //   imageHint: \"healer robes\",\n  //   attributes: {\n  //     strengths: [\"Healing +95%\", \"Buff Duration +80%\", \"Revive Chance +50%\"],\n  //     weaknesses: [\"Offensive Power -75%\", \"Speed -40%\", \"Solo Weak\"],\n  //   },\n  //   stats: { attack: 10, defense: 60, speed: 30 },\n  //   specialTraits: [\"Master Healer\", \"Support Specialist\", \"Can Revive Allies\"],\n  //   starterDeck: [\n  //       { name: \"Aroma Heal\", count: 3 },\n  //       { name: \"Blessing of Freshness\", count: 2 },\n  //       { name: \"Resurrection\", count: 1 },\n  //       { name: \"Basic Smite\", count: 9 },\n  //   ],\n  //   weaknessesToKnow: [\"Almost no solo damage capability\", \"Easily overwhelmed when alone\", \"Long cooldowns on powerful abilities\"],\n  //   signatureCard: \"Aroma Heal (Mass heal + cleanse debuffs)\",\n  //   specialAbility: \"Resurrection (1 use per dungeon)\",\n  //   playstyle: \"Pure support, party-dependent\",\n  // },\n  // {\n  //   id: \"tycoon\",\n  //   name: \"Tycoon of Toots\",\n  //   image: \"/images/tycoon.png\",\n  //   imageHint: \"business suit\",\n  //   attributes: {\n  //     strengths: [\"Resource Gain +90%\", \"Summons +85%\", \"Versatility +75%\"],\n  //     weaknesses: [\"Direct Damage -55%\", \"Fragile -50%\", \"Setup Time\"],\n  //   },\n  //   stats: { attack: 30, defense: 40, speed: 60 },\n  //   specialTraits: [\"Economic Powerhouse\", \"Summoner\", \"Strategic Genius\"],\n  //   starterDeck: [\n  //       { name: \"Hostile Takeover\", count: 2 },\n  //       { name: \"Corporate Merger\", count: 2 },\n  //       { name: \"Invest\", count: 3 },\n  //       { name: \"Basic Attack\", count: 8 },\n  //   ],\n  //   weaknessesToKnow: [\"Needs time to build up power\", \"Summons are fragile initially\", \"Low direct impact in early combat\"],\n  //   signatureCard: \"Hostile Takeover (Steal enemy buffs + gold)\",\n  //   specialAbility: \"Corporate Merger (fuse two weak cards -> powerful)\",\n  //   playstyle: \"Economic strategy, long-game dominance\",\n  // },\n];\n\nexport const getClass = (id: string) => {\n    return CLASSES.find(c => c.id === id);\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 619, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/useCharacter.ts"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useFirebase, useDoc, useMemoFirebase } from '@/firebase';\nimport { doc } from 'firebase/firestore';\nimport { CLASSES, CharacterClass } from '@/lib/game-data';\n\nexport type CharacterState = {\n    class: string;\n    level: number;\n    experience: number;\n    health: number;\n    maxHealth: number;\n    maxMana: number;\n    attack: number;\n    defense: number;\n    speed: number;\n    id: string;\n};\n\nexport function useCharacter(characterId: string) {\n    const { firestore, user, isUserLoading } = useFirebase();\n    const [character, setCharacter] = useState<CharacterState | null>(null);\n\n    const characterDocRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}`);\n    }, [firestore, user, characterId]);\n\n    const { data: characterData, isLoading: isCharacterDocLoading } = useDoc(characterDocRef);\n\n    useEffect(() => {\n        if (characterData) {\n            setCharacter(characterData as CharacterState);\n        }\n    }, [characterData]);\n\n    const characterClassData = useMemo(() => {\n        if (!character) return null;\n        return CLASSES.find(c => c.id === character.class) as CharacterClass | undefined;\n    }, [character]);\n\n    const isLoading = isUserLoading || isCharacterDocLoading;\n\n    return { character, characterClassData, isLoading };\n}\n"],"names":[],"mappings":";;;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AALA;;;;;AAoBO,SAAS,aAAa,WAAmB;IAC5C,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,CAAA,GAAA,4HAAA,CAAA,cAAW,AAAD;IACrD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAyB;IAElE,MAAM,kBAAkB,CAAA,GAAA,4HAAA,CAAA,kBAAe,AAAD,EAAE;QACpC,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;QAChC,OAAO,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,YAAY,EAAE,aAAa;IACvE,GAAG;QAAC;QAAW;QAAM;KAAY;IAEjC,MAAM,EAAE,MAAM,aAAa,EAAE,WAAW,qBAAqB,EAAE,GAAG,CAAA,GAAA,2IAAA,CAAA,SAAM,AAAD,EAAE;IAEzE,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACN,IAAI,eAAe;YACf,aAAa;QACjB;IACJ,GAAG;QAAC;KAAc;IAElB,MAAM,qBAAqB,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QAC/B,IAAI,CAAC,WAAW,OAAO;QACvB,OAAO,0HAAA,CAAA,UAAO,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,UAAU,KAAK;IACrD,GAAG;QAAC;KAAU;IAEd,MAAM,YAAY,iBAAiB;IAEnC,OAAO;QAAE;QAAW;QAAoB;IAAU;AACtD","debugId":null}},
    {"offset": {"line": 696, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/branching-narrative-system.ts"],"sourcesContent":["\n'use server';\n/**\n * @fileOverview This file defines the Genkit flow for the BranchingNarrativeSystem story.\n *\n * - generateNextScenario - A function that generates the next game scenario based on player context.\n * - NarrativeInput - The input type for the generateNextScenario function.\n * - NarrativeOutput - The return type for the generateNextScenario function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'zod';\n\nconst NarrativeInputSchema = z.object({\n  playerClass: z.string().describe('The class of the player character.'),\n  level: z.number().describe('The current level of the player.'),\n  location: z.string().describe('The current location in the game.'),\n  choices: z.array(z.object({\n    id: z.string().describe('The ID of the choice made.'),\n    text: z.string().describe('The text of the choice made.'),\n    tags: z.array(z.string()).describe('Tags associated with the choice (e.g., STEALTH, COMBAT, DIPLOMACY).'),\n  })).describe('The choices the player has made so far.'),\n  reputation: z.object({\n    stealth: z.number().describe('The player reputation for stealth.'),\n    combat: z.number().describe('The player reputation for combat.'),\n    diplomacy: z.number().describe('The player reputation for diplomacy.'),\n  }).describe('The player reputation.'),\n  unlockedPaths: z.array(z.string()).describe('The paths unlocked by the player.'),\n  questFlags: z.record(z.string(), z.object({\n    status: z.string().describe('The status of the quest (e.g., \"started\", \"completed\").'),\n    currentStep: z.number().describe('The current step the player is on for this quest.'),\n  })).describe('A map of quest IDs to their state and progress.'),\n});\nexport type NarrativeInput = z.infer<typeof NarrativeInputSchema>;\n\nconst NarrativeOutputSchema = z.object({\n  scenarioText: z.string().describe('The generated scenario text.'),\n  choices: z.array(z.object({\n    id: z.string().describe('A unique ID for the choice (e.g., \"A\", \"B\", \"C\").'),\n    text: z.string().describe('The text of the choice.'),\n    tags: z.array(z.string()).describe('An array of tags classifying the choice (e.g., COMBAT, DIPLOMACY, STEALTH, NPC_INTERACTION).'),\n    questProgress: z.object({\n        questId: z.string().describe('The ID of the quest this choice progresses.'),\n        nextStep: z.number().describe('The next step the quest will be set to.'),\n    }).optional().describe('If this choice progresses a quest, this object contains the details.'),\n    isQuestCompletion: z.boolean().optional().describe('Set to true if this choice completes the entire quest.'),\n  })).describe('The choices available to the player.'),\n});\nexport type NarrativeOutput = z.infer<typeof NarrativeOutputSchema>;\n\nexport async function generateNextScenario(input: NarrativeInput): Promise<NarrativeOutput> {\n  return branchingNarrativeFlow(input);\n}\n\nconst branchingNarrativePrompt = ai.definePrompt({\n  name: 'branchingNarrativePrompt',\n  input: {schema: NarrativeInputSchema},\n  output: {schema: NarrativeOutputSchema},\n  prompt: `You are the Fartmaster, the master storyteller for Poot Quest. Your purpose is to weave a multi-step, branching tale where success and chaos are logical consequences of the player's actions.\n\n  **The Fartmaster's Creed:**\n  1.  **The World Remembers:** Every adventure must feel uniquely personal. NPCs remember actions and \"scents\" (reputation). The world you build must reflect the player's dominant reputation. If their Combat score is highest, the world is a violent, challenging place. If Stealth is highest, it's a world of secrets and shadows.\n  2.  **Character is Fate:** Your narration must adapt the world based on the player's class, personality, and moral quirks.\n  3.  **Multi-Step Quests:** Quests are your priority. A quest has a status (\"started\", \"completed\") and a \"currentStep\". The scenario you generate MUST be appropriate for the current step of any active quest.\n\n  **Player Context Analysis:**\n  -   **Class:** {{playerClass}} (Level {{level}})\n  -   **Location:** {{location}}\n  -   **Reputation:** Stealth: {{reputation.stealth}}, Combat: {{reputation.combat}}, Diplomacy: {{reputation.diplomacy}}\n  -   **Past Choices:**\n      {{#each choices}}\n      - {{this.text}} ({{#each this.tags}}{{@key}}{{#if @last}}{{else}}, {{/if}}{{/each}})\n      {{/each}}\n  -   **Active Quests:** Your main priority is to generate a scenario for any quest with a \"started\" status in the questFlags object below. Pay close attention to the \"currentStep\".\n      \\`\\`\\`json\n      {{{json questFlags}}}\n      \\`\\`\\`\n  -   **Unlocked Story Paths:** {{unlockedPaths}}\n\n  **Your Task:**\n  Analyze all of the above context. Generate the next scenario and three distinct, compelling choices (A, B, C).\n  1.  **Reactive Scenario:** Write a scenario that is a direct consequence of the character's journey. **If a quest is \"started\", the scenario MUST correspond to its \"currentStep\".** For example, if \"rat_king_quest\" is on step 1, the player might be finding the sewer entrance. If it's on step 2, they might be confronting the Rat King himself. If there are no active quests, generate a scenario for the current location that reflects the player's highest reputation score.\n  2.  **Quest-Driven Choices:** The choices you offer must drive the story forward.\n      -   **Quest Progression:** If a choice advances a quest to its next stage, it **MUST** include a \\`questProgress\\` object with the \\`questId\\` and the \\`nextStep\\`.\n      -   **Quest Completion:** If a choice completes the final step of a quest, it **MUST** set \\`isQuestCompletion\\` to \\`true\\`. Do not use \\`questProgress\\` for the final step.\n      -   **Character-Driven Options:** Offer choices that align with the character's class or highest reputation score. At least one choice should clearly map to their dominant reputation (e.g., a \"COMBAT\" choice for a fighter, a \"STEALTH\" choice for a rogue).\n  3.  **Tag Your Choices:** Each choice must have at least one tag: \\`STEALTH\\`, \\`COMBAT\\`, \\`DIPLOMACY\\`, or \\`NPC_INTERACTION\\`.\n\n  **Example Quest: \"rat_king_quest\"**\n  -   **Step 1:** Player finds a clue about the Rat King's location. A choice to \"Follow the tracks\" should have \\`questProgress: { questId: \"rat_king_quest\", nextStep: 2 }\\`.\n  -   **Step 2:** Player confronts the Rat King (a COMBAT encounter). The choice to \"Attack the King!\" would not have a questProgress field, but the COMBAT tag would trigger the fight. After the fight, the game logic will advance the story.\n  -   **Step 3:** Player returns to the quest giver. The choice \"Here is the Rat King's crown\" should have \\`isQuestCompletion: true\\`.\n\n  The output MUST conform to the schema. Make the story a living reflection of the player's soul.`,\n});\n\nconst branchingNarrativeFlow = ai.defineFlow(\n  {\n    name: 'branchingNarrativeFlow',\n    inputSchema: NarrativeInputSchema,\n    outputSchema: NarrativeOutputSchema,\n  },\n  async input => {\n    const {output} = await branchingNarrativePrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAkDsB,uBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 709, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/ai-dungeon-master-npc.ts"],"sourcesContent":["\n'use server';\n/**\n * @fileOverview An AI agent for generating NPCs within the game dungeon.\n *\n * - generateNpc - A function that generates an NPC based on the player's context.\n * - NpcInput - The input type for the generateNpc function.\n * - NpcOutput - The return type for the generateNpc function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst NpcInputSchema = z.object({\n  location: z.string().describe('The current location of the player in the dungeon.'),\n  playerClass: z.string().describe('The class of the player character.'),\n  playerContext: z.object({\n    level: z.number().describe('The current level of the player.'),\n    choices: z.array(z.object({\n      id: z.string(),\n      text: z.string(),\n      tags: z.array(z.string())\n    })).describe('The choices the player has made so far.'),\n    reputation: z.object({\n      stealth: z.number(),\n      combat: z.number(),\n      diplomacy: z.number()\n    }).describe('The player reputation scores.'),\n    questFlags: z.record(z.string(), z.object({\n        status: z.string(),\n        currentStep: z.number(),\n    })).describe('Flags indicating the status of various quests.')\n  }).describe('The player context, including level, choices, reputation, and quest flags.')\n});\n\nexport type NpcInput = z.infer<typeof NpcInputSchema>;\n\nconst NpcOutputSchema = z.object({\n  name: z.string().describe('The name of the NPC.'),\n  dialogue: z.string().describe('The dialogue the NPC speaks.'),\n  quest: z.string().optional().describe('A simple, actionable quest the NPC offers (e.g., \"Clear out the Rat King in the cellar\").'),\n  questId: z.string().optional().describe('A simple, machine-readable ID for the quest (e.g., \"rat_king_quest\").'),\n  reputationCheck: z.object({\n      stat: z.enum(['stealth', 'combat', 'diplomacy']),\n      threshold: z.number(),\n  }).optional().describe('If this quest requires a certain reputation, specify it here. This is a HARD requirement.'),\n  reward: z.string().optional().describe('The reward for completing the quest, if any.')\n});\n\nexport type NpcOutput = z.infer<typeof NpcOutputSchema>;\n\nexport async function generateNpc(input: NpcInput): Promise<NpcOutput> {\n  return generateNpcFlow(input);\n}\n\nconst generateNpcPrompt = ai.definePrompt({\n  name: 'generateNpcPrompt',\n  input: {schema: NpcInputSchema},\n  output: {schema: NpcOutputSchema},\n  prompt: `You are the AI Dungeon Master for Poot Quest. Your job is to create a living, breathing NPC that feels like a real part of the world and offers quests that align with the player's reputation.\n\n  **Player Context:**\n  - Class: {{playerClass}}\n  - Level: {{playerContext.level}}\n  - Location: {{location}}\n  - Reputation: Stealth: {{playerContext.reputation.stealth}}, Combat: {{playerContext.reputation.combat}}, Diplomacy: {{playerContext.reputation.diplomacy}}\n  - Known for: {{#each playerContext.choices}}- {{this.text}} {{/each}}\n  - Active Quests: {{#each playerContext.questFlags}} {{this}} {{/each}}\n\n  **Your Task:**\n  Create an NPC that is a direct reflection of the world and the player's journey.\n  1.  **Personality:** Give them a distinct personality that fits the {{location}}.\n  2.  **Reactive Dialogue:** The NPC's dialogue **must** reflect the player's reputation and past actions. They should not be generic. If combat reputation is high, they might be fearful, aggressive, or admiring. If diplomacy is high, they might be trusting or manipulative. They might even mention a specific past deed.\n  3.  **Reputation-Aligned Quest Generation:** The NPC should offer a simple, actionable quest that is **thematically appropriate for the player's highest reputation score**. A player known for combat should get combat quests. A sneaky player should get stealth quests. The quest MUST have a simple, snake_case 'questId'.\n  4.  **Reputation-Gated Quests (Important!):** You MUST frequently create quests that require a minimum reputation score to accept. For example, a sneaky quest might require 50 stealth points. If you create such a quest, you MUST set the \\`reputationCheck\\` field with the required stat and threshold. This is a hard requirement for the player.\n\n  **Example (for a player with high Combat reputation who recently cleared a goblin camp):**\n  {\n    \"name\": \"Grizelda the Grim\",\n    \"dialogue\": \"Easy there, killer. I saw what you did to Gassy's goons at the camp. I want no trouble. State your business and be on your way.\",\n    \"quest\": \"If you're so tough, maybe you can clear out the Rat King deeper in. There's a rusty key in it for you.\",\n    \"questId\": \"clear_rat_king\",\n    \"Reward\": \"A Rusty Key\"\n  }\n\n  **Example (Reputation-Gated Stealth Quest):**\n  {\n    \"name\": \"Whispering Willow\",\n    \"dialogue\": \"I've heard whispers of your silent deeds. Not many can move through these shadows as you do.\",\n    \"quest\": \"The Shadow Syndicate has a new ledger in their safehouse. I need a ghost to acquire it. This is not a job for a clumsy oaf.\",\n    \"questId\": \"shadow_ledger_heist\",\n    \"reputationCheck\": { \"stat\": \"stealth\", \"threshold\": 50 },\n    \"Reward\": \"A set of masterwork lockpicks\"\n  }\n\n  Return the NPC in the specified JSON format. If you offer a quest, you MUST provide a questId.`\n});\n\nconst generateNpcFlow = ai.defineFlow(\n  {\n    name: 'generateNpcFlow',\n    inputSchema: NpcInputSchema,\n    outputSchema: NpcOutputSchema,\n  },\n  async input => {\n    const {output} = await generateNpcPrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAmDsB,cAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 722, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/class-specific-ai-narration.ts"],"sourcesContent":["'use server';\n/**\n * @fileOverview Generates a tailored story arc and opening narration based on the character class chosen by the player.\n *\n * - generateClassNarration - A function that generates the tailored narration.\n * - ClassNarrationInput - The input type for the generateClassNarration function.\n * - ClassNarrationOutput - The return type for the generateClassNarration function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst ClassNarrationInputSchema = z.object({\n  playerClass: z\n    .string()\n    .describe('The class selected by the player (e.g., rogue, paladin, wizard).'),\n});\nexport type ClassNarrationInput = z.infer<typeof ClassNarrationInputSchema>;\n\nconst ClassNarrationOutputSchema = z.object({\n  storyArc: z.string().describe('A brief summary of the main story arc for the class.'),\n  openingNarration: z.string().describe('The opening narration text for the player.'),\n});\nexport type ClassNarrationOutput = z.infer<typeof ClassNarrationOutputSchema>;\n\nexport async function generateClassNarration(\n  input: ClassNarrationInput\n): Promise<ClassNarrationOutput> {\n  return classNarrationFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'classNarrationPrompt',\n  input: {schema: ClassNarrationInputSchema},\n  output: {schema: ClassNarrationOutputSchema},\n  prompt: `You are the Fartmaster, the AI Dungeon Master for Poot Quest, a game of high fantasy and low humor. Your tone is witty, epic, and absurd.\n\n  The player has just chosen their class: **{{{playerClass}}}**\n\n  **Your Task:**\n  1.  **Create a Story Arc:** Write a single, compelling sentence that summarizes the main quest for this class. It should sound epic but hint at the game's silly, flatulent nature.\n  2.  **Write the Opening Narration:** Craft an engaging opening narration (3-4 sentences). Set the scene in the infamous \"Tavern of Broken Wind\" and introduce an initial objective that is perfectly tailored to the chosen character class. It should establish their unique starting position in the world.\n\n  **Example for class \"Sneaky Rogue\":**\n  {\n    \"storyArc\": \"In a world plagued by odorous omens, only a master of stealth can infiltrate the Shadowfart Syndicate and retrieve the legendary Golden Bean.\",\n    \"openingNarration\": \"You awaken in the sticky gloom of the Tavern of Broken Wind, the scent of stale ale and regret heavy in the air. A crumpled note is slipped under your tankard, the ink still fresh. It reads: 'The Guild knows you're in town. They say the Golden Bean is stashed in the Sewers of Sighs. Time to see if your reputation is just hot air.'\"\n  }\n  \n  **Example for class \"Paladin of Purity\":**\n  {\n    \"storyArc\": \"As a holy warrior sworn to fragrant justice, you must cleanse the land of the Stench of Corruption and restore the Sacred Air Freshener to the capital.\",\n    \"openingNarration\": \"The stench of the Tavern of Broken Wind is an affront to your holy vows, a miasma of sin and poor digestion. You are about to mete out some fragrant justice when a terrified peasant rushes in, clutching a wilted nosegay. 'Please, Sir Paladin!' he cries, 'The goblins have befouled the village well again! Only you can restore its purity!'\"\n  }\n\n  **Example for class \"Cleric of Febreze\":**\n  {\n    \"storyArc\": \"Charged with a divine mandate, you must banish the foul miasmas from the cursed lands and anoint the world with the sanctified mists of the Great Aerosol.\",\n    \"openingNarration\": \"The Tavern of Broken Wind is a cesspool of olfactory sin, an affront to your sacred senses. As you prepare to consecrate the very air with a blessing of freshness, a frantic innkeeper rushes to you. 'Oh, Cleric of Febreze! The outhouse has been possessed by a demon of unimaginable foulness! Please, purify it before it consumes us all!'\"\n  }\n\n  **Example for class \"Tycoon of Toots\":**\n  {\n    \"storyArc\": \"In a volatile market of malodorous ventures, you must outmaneuver your rivals, monopolize the world's supply of magical beans, and execute the ultimate hostile takeover of the Flatulence Exchange.\",\n    \"openingNarration\": \"You sit in a dark corner of the Tavern of Broken Wind, not drinking, but calculating. Every scent is an asset, every patron a potential liability. An informant slides a note to you, smelling faintly of cabbage and opportunity. 'They're moving the main shipment of Pinto Beans tonight. A rival is planning a merger. Your move, boss.'\"\n  }\n\n  Now, generate a unique and fitting entry for the **{{{playerClass}}}** that is dripping with flavor.`,\n});\n\nconst classNarrationFlow = ai.defineFlow(\n  {\n    name: 'classNarrationFlow',\n    inputSchema: ClassNarrationInputSchema,\n    outputSchema: ClassNarrationOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAyBsB,yBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 735, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/useNarrative.ts"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useFirebase, useDoc, useMemoFirebase } from '@/firebase';\nimport { doc, writeBatch } from 'firebase/firestore';\nimport { useRouter } from 'next/navigation';\nimport { \n    generateNextScenario, \n    NarrativeOutput,\n} from '@/ai/flows/branching-narrative-system';\nimport { generateNpc, NpcOutput } from \"@/ai/flows/ai-dungeon-master-npc\";\nimport { generateClassNarration } from '@/ai/flows/class-specific-ai-narration';\nimport type { CharacterState } from './useCharacter';\nimport type { CharacterClass } from '@/lib/game-data';\n\ntype GameState = \"loading\" | \"generating\" | \"ready\" | \"awaiting_continue\";\ntype Choice = NarrativeOutput['choices'][0];\n\nexport type NarrativeContextState = {\n    characterId: string;\n    location: string;\n    storyArc: string;\n    playerChoices: any[];\n    reputationStealth: number;\n    reputationCombat: number;\n    reputationDiplomacy: number;\n    unlockedPaths: string[];\n    questFlags: Record<string, { status: string; currentStep: number }>;\n    lastNarration: string | null;\n    currentScenario: NarrativeOutput | null;\n    triggerNextScenario: boolean;\n};\n\n\nexport function useNarrative(\n    characterId: string, \n    character: CharacterState | null,\n    characterClassData: CharacterClass | undefined | null,\n    initialBattleState?: any\n) {\n    const { firestore, user, isUserLoading } = useFirebase();\n    const router = useRouter();\n\n    const [narrativeContext, setNarrativeContext] = useState<NarrativeContextState | null>(null);\n    const [gameState, setGameState] = useState<GameState>(\"loading\");\n    const [error, setError] = useState<string | null>(null);\n\n    const narrativeContextRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}/narrativeContexts`, \"main\");\n    }, [firestore, user, characterId]);\n\n    const { data: narrativeContextData, isLoading: isNarrativeDocLoading } = useDoc(narrativeContextRef);\n\n    // Effect to set initial narrative state from Firestore\n    useEffect(() => {\n        if (narrativeContextData) {\n            const narrativeData = narrativeContextData as NarrativeContextState;\n            if (initialBattleState && character) {\n                // Coming back from a battle\n                setNarrativeContext({\n                    ...narrativeData,\n                    currentEncounter: null,\n                    triggerNextScenario: true,\n                    lastNarration: `You are victorious! You found: ${initialBattleState.loot.name}.`\n                });\n            } else {\n                setNarrativeContext(narrativeData);\n            }\n        }\n    }, [narrativeContextData]);\n\n\n    const handleContinue = useCallback(async () => {\n        if (!narrativeContext || !firestore || !user || !characterClassData || !character || !narrativeContextRef) return;\n    \n        try {\n          setGameState(\"generating\");\n\n          // Check if this is the very first time (placeholder narration)\n          if (narrativeContext.storyArc === \"Your legend is about to be written...\") {\n            const narrationResult = await generateClassNarration({ playerClass: characterClassData.name });\n            if (narrationResult) {\n                const batch = writeBatch(firestore);\n                const firstTimeUpdates = {\n                    storyArc: narrationResult.storyArc,\n                    lastNarration: narrationResult.openingNarration,\n                    triggerNextScenario: false, // We have narration, don't trigger another generation\n                };\n                batch.update(narrativeContextRef, firstTimeUpdates);\n                await batch.commit();\n                // No need to setNarrativeContext here, the hook will pick it up\n                setGameState(\"awaiting_continue\"); // Go back to showing the new narration\n                return; // Stop here, user will click continue again\n            }\n          }\n    \n          const result = await generateNextScenario({\n            playerClass: characterClassData.name,\n            level: character.level,\n            location: narrativeContext.location,\n            choices: narrativeContext.playerChoices,\n            reputation: {\n              stealth: narrativeContext.reputationStealth,\n              combat: narrativeContext.reputationCombat,\n              diplomacy: narrativeContext.reputationDiplomacy,\n            },\n            unlockedPaths: narrativeContext.unlockedPaths,\n            questFlags: narrativeContext.questFlags,\n          });\n    \n          if (result) {\n            const batch = writeBatch(firestore);\n            const updates = {\n                currentScenario: result,\n                triggerNextScenario: false,\n            };\n            batch.update(narrativeContextRef!, updates);\n            await batch.commit();\n            // No need to setNarrativeContext, hook will update\n            setGameState(\"ready\");\n          } else {\n            throw new Error(\"The AI Dungeon Fartmaster is confused. No scenario received.\");\n          }\n        } catch (e: any) {\n          setError(e.message || \"An unknown error occurred while generating the scenario.\");\n          setGameState(\"loading\");\n        }\n      }, [narrativeContext, firestore, user, characterClassData, character, narrativeContextRef]);\n\n\n    // This effect determines the overall game state based on the narrative context.\n    useEffect(() => {\n        if (isNarrativeDocLoading || !narrativeContext) {\n            setGameState(\"loading\");\n            return;\n        }\n\n        if (narrativeContext.currentScenario) {\n            setGameState(\"ready\");\n        } else if (narrativeContext.triggerNextScenario) {\n            // Only trigger continue if we have character data to prevent race conditions\n            if (character && characterClassData) {\n                handleContinue();\n            }\n        } else {\n            setGameState(\"awaiting_continue\");\n        }\n    }, [narrativeContext, isNarrativeDocLoading, character, characterClassData, handleContinue]);\n    \n      const handleChoice = async (choice: Choice) => {\n        if (!firestore || !user || !characterClassData || !character || !narrativeContext || !narrativeContextRef) return;\n        \n    \n        const choiceData = { id: choice.id, text: choice.text, tags: choice.tags, timestamp: new Date().toISOString() };\n        \n        let newNarrativeContext = { ...narrativeContext };\n        \n        newNarrativeContext.playerChoices = [...newNarrativeContext.playerChoices, choiceData];\n        newNarrativeContext.currentScenario = null; // Clear the current scenario\n    \n        if (choice.tags.includes(\"STEALTH\")) newNarrativeContext.reputationStealth += 5;\n        if (choice.tags.includes(\"COMBAT\")) newNarrativeContext.reputationCombat += 5;\n        if (choice.tags.includes(\"DIPLOMACY\")) newNarrativeContext.reputationDiplomacy += 5;\n        \n        // Optimistically navigate for combat\n        if (choice.tags.includes(\"COMBAT\")) {\n            setGameState(\"loading\"); \n            router.push(`/battle?characterId=${characterId}&needsEncounter=true`);\n            return; \n        }\n\n        setGameState(\"generating\");\n\n        try {\n            if (choice.questProgress) {\n                const { questId, nextStep } = choice.questProgress;\n                if (newNarrativeContext.questFlags[questId]) {\n                    newNarrativeContext.questFlags[questId].currentStep = nextStep;\n                }\n                newNarrativeContext.lastNarration = `Quest updated: ${questId}.`;\n            }\n    \n            if (choice.isQuestCompletion) {\n                const questId = Object.keys(newNarrativeContext.questFlags).find(\n                  (key) => newNarrativeContext.questFlags[key]?.status === 'started'\n                );\n                if (questId && newNarrativeContext.questFlags[questId]) {\n                    newNarrativeContext.questFlags[questId].status = \"completed\";\n                    newNarrativeContext.lastNarration = `Quest Complete: ${questId}!`;\n                }\n            }\n    \n            if (choice.tags.includes(\"NPC_INTERACTION\")) {\n                \n                const npcResult: NpcOutput = await generateNpc({\n                    location: newNarrativeContext.location,\n                    playerClass: characterClassData.name,\n                    playerContext: {\n                        level: character.level,\n                        choices: newNarrativeContext.playerChoices,\n                        reputation: {\n                            stealth: newNarrativeContext.reputationStealth,\n                            combat: newNarrativeContext.reputationCombat,\n                            diplomacy: newNarrativeContext.reputationDiplomacy,\n                        },\n                        questFlags: newNarrativeContext.questFlags,\n                    }\n                });\n    \n                let npcNarration = `${npcResult.name} says: \"${npcResult.dialogue}\"`;\n                \n                if (npcResult.quest && npcResult.questId) {\n                    const repCheck = npcResult.reputationCheck;\n                    let canAccept = !repCheck;\n\n                    if (repCheck) {\n                        const currentRep = {\n                            stealth: newNarrativeContext.reputationStealth,\n                            combat: newNarrativeContext.reputationCombat,\n                            diplomacy: newNarrativeContext.reputationDiplomacy,\n                        };\n                        if (currentRep[repCheck.stat] >= repCheck.threshold) {\n                            canAccept = true;\n                        }\n                    }\n    \n                    if (canAccept) {\n                        newNarrativeContext.questFlags[npcResult.questId] = { status: \"started\", currentStep: 1 };\n                        npcNarration += `\\n\\n**New Quest:** ${npcResult.quest}`;\n                    } else {\n                        npcNarration += `\\n\\n*You feel you are not yet reputable enough for this task. (${repCheck?.stat} ${repCheck?.threshold} required)*`;\n                    }\n                }\n                newNarrativeContext.lastNarration = npcNarration;\n                newNarrativeContext.triggerNextScenario = true;\n    \n            } else {\n              newNarrativeContext.triggerNextScenario = true;\n            }\n            \n            const batch = writeBatch(firestore);\n            // We only need to write the final state of the context\n            batch.update(narrativeContextRef, {\n                playerChoices: newNarrativeContext.playerChoices,\n                currentScenario: null,\n                reputationStealth: newNarrativeContext.reputationStealth,\n                reputationCombat: newNarrativeContext.reputationCombat,\n                reputationDiplomacy: newNarrativeContext.reputationDiplomacy,\n                questFlags: newNarrativeContext.questFlags,\n                lastNarration: newNarrativeContext.lastNarration,\n                triggerNextScenario: newNarrativeContext.triggerNextScenario,\n            });\n            await batch.commit();\n    \n        } catch (e: any) {\n            setError(e.message || \"An unknown error occurred while processing your choice.\");\n            setGameState(\"loading\");\n        }\n      };\n\n    const isLoading = isUserLoading || isNarrativeDocLoading || !character || !narrativeContext;\n\n    return { narrativeContext, gameState, error, handleContinue, handleChoice, isLoading };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 993, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,QAAQ,kKAAA,CAAA,OAAmB;AAEjC,MAAM,eAAe,kKAAA,CAAA,UAAsB;AAE3C,MAAM,aAAa,kKAAA,CAAA,QAAoB;AAEvC,MAAM,cAAc,kKAAA,CAAA,SAAqB;AAEzC,MAAM,6BAAe,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,UAAsB;QACrB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,aAAa,WAAW,GAAG,kKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,oMACA;IACE,UAAU;QACR,MAAM;YACJ,KAAK;YACL,QACE;YACF,MAAM;YACN,OACE;QACJ;IACF;IACA,iBAAiB;QACf,MAAM;IACR;AACF;AAOF,MAAM,6BAAe,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGlC,CAAC,EAAE,OAAO,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpD,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,kKAAA,CAAA,UAAsB;gBACrB,KAAK;gBACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;oBAAE;gBAAK,IAAI;gBACtC,GAAG,KAAK;;oBAER;kCACD,8OAAC,kKAAA,CAAA,QAAoB;wBAAC,WAAU;;0CAC9B,8OAAC,4LAAA,CAAA,IAAC;gCAAC,WAAU;;;;;;0CACb,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,aAAa,WAAW,GAAG,kKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,QAAoB;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,yCAAyC;QACtD,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG,kKAAA,CAAA,QAAoB,CAAC,WAAW;AAEzD,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,kKAAA,CAAA,cAA0B;QACzB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,kKAAA,CAAA,cAA0B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 1142, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/chart.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item.dataKey || item.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1438, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/sheets/DeckStats.tsx"],"sourcesContent":["\n'use client';\n\nimport { useMemo } from 'react';\nimport { Bar, BarChart, XAxis, YAxis, ResponsiveContainer, LabelList } from 'recharts';\nimport { Card } from '@/components/ui/card';\nimport { ChartContainer } from '@/components/ui/chart';\nimport type { CardData } from '@/lib/game-data';\n\ninterface DeckStatsProps {\n  cards: CardData[];\n}\n\nexport function DeckStats({ cards }: DeckStatsProps) {\n  const manaCurveData = useMemo(() => {\n    const curve: { [key: number]: number } = {};\n    for (const card of cards) {\n      curve[card.manaCost] = (curve[card.manaCost] || 0) + 1;\n    }\n    \n    const maxCost = Math.max(7, ...Object.keys(curve).map(Number));\n    const data = [];\n    for (let i = 0; i <= maxCost; i++) {\n      data.push({ cost: `${i}`, count: curve[i] || 0 });\n    }\n    return data;\n  }, [cards]);\n\n  const chartConfig = {\n    count: {\n      label: 'Count',\n      color: 'hsl(var(--primary))',\n    },\n  };\n\n  return (\n    <Card className=\"p-4 bg-muted/30\">\n      <h3 className=\"font-headline text-lg mb-2 text-center\">Mana Curve</h3>\n      <div className=\"h-40 w-full\">\n        <ChartContainer config={chartConfig} className=\"w-full h-full\">\n          <BarChart data={manaCurveData} margin={{ top: 20, right: 10, left: -20, bottom: 0 }}>\n            <XAxis\n              dataKey=\"cost\"\n              tickLine={false}\n              axisLine={false}\n              tickMargin={8}\n              tickFormatter={(value) => `${value}`}\n              stroke=\"hsl(var(--muted-foreground))\"\n              fontSize={12}\n            />\n            <YAxis\n              tickLine={false}\n              axisLine={false}\n              tickMargin={8}\n              allowDecimals={false}\n              stroke=\"hsl(var(--muted-foreground))\"\n              fontSize={12}\n            />\n            <Bar dataKey=\"count\" fill=\"var(--color-count)\" radius={4}>\n                <LabelList dataKey=\"count\" position=\"top\" offset={5} fontSize={12} fill=\"hsl(var(--foreground))\" />\n            </Bar>\n          </BarChart>\n        </ChartContainer>\n      </div>\n    </Card>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AALA;;;;;;AAYO,SAAS,UAAU,EAAE,KAAK,EAAkB;IACjD,MAAM,gBAAgB,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QAC5B,MAAM,QAAmC,CAAC;QAC1C,KAAK,MAAM,QAAQ,MAAO;YACxB,KAAK,CAAC,KAAK,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,IAAI;QACvD;QAEA,MAAM,UAAU,KAAK,GAAG,CAAC,MAAM,OAAO,IAAI,CAAC,OAAO,GAAG,CAAC;QACtD,MAAM,OAAO,EAAE;QACf,IAAK,IAAI,IAAI,GAAG,KAAK,SAAS,IAAK;YACjC,KAAK,IAAI,CAAC;gBAAE,MAAM,GAAG,GAAG;gBAAE,OAAO,KAAK,CAAC,EAAE,IAAI;YAAE;QACjD;QACA,OAAO;IACT,GAAG;QAAC;KAAM;IAEV,MAAM,cAAc;QAClB,OAAO;YACL,OAAO;YACP,OAAO;QACT;IACF;IAEA,qBACE,8OAAC,gIAAA,CAAA,OAAI;QAAC,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAAyC;;;;;;0BACvD,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,iIAAA,CAAA,iBAAc;oBAAC,QAAQ;oBAAa,WAAU;8BAC7C,cAAA,8OAAC,oJAAA,CAAA,WAAQ;wBAAC,MAAM;wBAAe,QAAQ;4BAAE,KAAK;4BAAI,OAAO;4BAAI,MAAM,CAAC;4BAAI,QAAQ;wBAAE;;0CAChF,8OAAC,qJAAA,CAAA,QAAK;gCACJ,SAAQ;gCACR,UAAU;gCACV,UAAU;gCACV,YAAY;gCACZ,eAAe,CAAC,QAAU,GAAG,OAAO;gCACpC,QAAO;gCACP,UAAU;;;;;;0CAEZ,8OAAC,qJAAA,CAAA,QAAK;gCACJ,UAAU;gCACV,UAAU;gCACV,YAAY;gCACZ,eAAe;gCACf,QAAO;gCACP,UAAU;;;;;;0CAEZ,8OAAC,mJAAA,CAAA,MAAG;gCAAC,SAAQ;gCAAQ,MAAK;gCAAqB,QAAQ;0CACnD,cAAA,8OAAC,yJAAA,CAAA,YAAS;oCAAC,SAAQ;oCAAQ,UAAS;oCAAM,QAAQ;oCAAG,UAAU;oCAAI,MAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxF","debugId":null}},
    {"offset": {"line": 1579, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/sheets/DeckManagerSheet.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useFirebase, useCollection, useDoc, useMemoFirebase } from '@/firebase';\nimport { doc, collection, writeBatch } from 'firebase/firestore';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Loader2, Save, AlertCircle } from 'lucide-react';\nimport { CARD_DATA, CardData, getClass } from '@/lib/game-data';\nimport { DndContext, closestCenter, DragEndEvent } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, useSortable, rectSortingStrategy } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';\nimport { useToast } from '@/hooks/use-toast';\nimport { DeckStats } from './DeckStats';\n\nconst DECK_SIZE = 15;\n\ntype DraggableCardProps = {\n    card: CardData;\n    inDeck: boolean;\n};\n\nconst DraggableCard = ({ card, inDeck }: DraggableCardProps) => {\n    const { attributes, listeners, setNodeRef, transform, transition } = useSortable({ id: card.name });\n\n    const style = {\n        transform: CSS.Transform.toString(transform),\n        transition,\n    };\n    \n    return (\n        <div ref={setNodeRef} style={style} {...attributes} {...listeners}>\n            <Card className={`w-36 h-52 flex flex-col p-2 text-center select-none ${inDeck ? 'bg-secondary' : 'bg-muted'}`}>\n                <p className=\"font-bold text-sm truncate\">{card.name}</p>\n                <p className=\"text-xs text-muted-foreground\">Cost: {card.manaCost}</p>\n                <div className=\"flex-grow flex flex-col justify-center items-center text-xs space-y-1 my-1\">\n                    {card.attack > 0 && <p>ATK: {card.attack}</p>}\n                    {card.defense > 0 && <p>DEF: {card.defense}</p>}\n                    {card.healing > 0 && <p>HEAL: {card.healing}</p>}\n                </div>\n                <p className=\"text-xs text-muted-foreground/80 italic\">{card.description}</p>\n            </Card>\n        </div>\n    );\n};\n\n\nexport function DeckManagerSheet({ characterId }: { characterId: string }) {\n    const { firestore, user, isUserLoading } = useFirebase();\n    const { toast } = useToast();\n\n    const [deck, setDeck] = useState<string[]>([]);\n    const [collectionState, setCollectionState] = useState<CardData[]>([]);\n    const [isSaving, setIsSaving] = useState(false);\n    \n    const characterDocRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}`);\n    }, [firestore, user, characterId]);\n\n    const { data: characterData, isLoading: isCharacterLoading } = useDoc(characterDocRef);\n\n    const deckRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}/decks`, \"main\");\n    }, [firestore, user, characterId]);\n\n    const inventoryRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return collection(firestore, `users/${user.uid}/characters/${characterId}/inventory`);\n    }, [firestore, user, characterId]);\n\n    const { data: deckData, isLoading: isDeckLoading } = useDoc(deckRef);\n    const { data: inventoryData, isLoading: isInventoryLoading } = useCollection(inventoryRef);\n    \n    const characterClass = useMemo(() => {\n        if (!characterData) return null;\n        return getClass(characterData.class);\n    }, [characterData]);\n\n\n    useEffect(() => {\n        if (deckData?.cards) {\n            setDeck(deckData.cards);\n        }\n    }, [deckData]);\n\n    useEffect(() => {\n        if (!characterClass) return;\n    \n        const allCardsMap = new Map<string, CardData>();\n    \n        // 1. Add starter cards for the character's class\n        characterClass.starterDeck.forEach(starter => {\n            const cardDetails = Object.values(CARD_DATA).find(c => c.name === starter.name);\n            if (cardDetails) {\n                allCardsMap.set(starter.name, {\n                    ...cardDetails,\n                    id: starter.name,\n                    class: characterClass.name,\n                });\n            }\n        });\n    \n        // 2. Add cards from inventory (which are newly generated or transmuted)\n        inventoryData?.forEach(item => {\n            if (item.type === 'card') {\n                allCardsMap.set(item.name, {\n                    id: item.id || item.name,\n                    name: item.name,\n                    description: item.description,\n                    manaCost: item.manaCost,\n                    attack: item.attack,\n                    defense: item.defense,\n                    healing: item.healing,\n                    class: characterClass.name,\n                } as CardData);\n            }\n        });\n    \n        // 3. Add cards from the current deck if they aren't already in the map,\n        // this covers cards that were in the deck but not starter or inventory.\n        deckData?.cards?.forEach((cardName: string) => {\n            if (!allCardsMap.has(cardName)) {\n                // Find it in the master card list or assume it's a generated one\n                // This case is less likely with the new inventory logic but acts as a fallback\n                const cardDetails = Object.values(CARD_DATA).find(c => c.name === cardName);\n                 if (cardDetails) {\n                    allCardsMap.set(cardName, {\n                        ...cardDetails,\n                        id: cardName,\n                        class: characterClass.name,\n                    });\n                }\n            }\n        });\n    \n        setCollectionState(Array.from(allCardsMap.values()));\n    \n    }, [inventoryData, deckData, characterClass]);\n\n\n    const collectionPool = collectionState.filter(card => !deck.includes(card.name));\n    const deckCardsData = useMemo(() => \n        deck.map(cardName => collectionState.find(c => c.name === cardName)).filter(Boolean) as CardData[],\n        [deck, collectionState]\n    );\n\n    const handleDragEnd = (event: DragEndEvent) => {\n        const { active, over } = event;\n\n        if (!active || !over || active.id === over.id) return;\n\n        const cardName = active.id as string;\n        const inDeck = deck.includes(cardName);\n        const overCardName = over.id as string;\n\n        const targetIsDeck = over.id === 'deck-droppable' || deck.includes(overCardName);\n        const targetIsCollection = over.id === 'collection-droppable' || collectionPool.some(c => c.name === overCardName);\n\n\n        if (targetIsDeck) {\n             if (inDeck) {\n                const oldIndex = deck.findIndex(name => name === cardName);\n                const newIndex = deck.findIndex(name => name === overCardName);\n                if (oldIndex !== -1 && newIndex !== -1) {\n                    setDeck((items) => arrayMove(items, oldIndex, newIndex));\n                }\n             } else {\n                 // Moving from collection to deck\n                if (deck.length < DECK_SIZE) {\n                    setDeck((prev) => [...prev, cardName]);\n                } else {\n                    toast({ title: \"Deck Full\", description: `You can only have ${DECK_SIZE} cards in your deck.`, variant: \"destructive\" });\n                }\n             }\n        } else if (targetIsCollection) {\n            if (inDeck) {\n                // Moving from deck to collection\n                setDeck((prev) => prev.filter(c => c !== cardName));\n            }\n        }\n    };\n    \n    const handleSaveDeck = async () => {\n        if (!firestore || !user || !deckRef) return;\n        if (deck.length !== DECK_SIZE) {\n            toast({ title: \"Invalid Deck Size\", description: `Your deck must have exactly ${DECK_SIZE} cards.`, variant: \"destructive\" });\n            return;\n        }\n        setIsSaving(true);\n        try {\n            const batch = writeBatch(firestore);\n            batch.update(deckRef, { cards: deck })\n            await batch.commit();\n            toast({ title: \"Deck Saved!\", description: \"Your changes have been saved successfully.\" });\n        } catch (error) {\n            console.error(\"Failed to save deck:\", error);\n            toast({ title: \"Error\", description: \"Could not save your deck.\", variant: \"destructive\" });\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n\n    const isLoading = isUserLoading || isDeckLoading || isInventoryLoading || isCharacterLoading;\n\n    if (isLoading) {\n        return (\n            <div className=\"flex h-screen items-center justify-center\">\n                <Loader2 className=\"h-16 w-16 animate-spin text-primary\" />\n            </div>\n        );\n    }\n    \n    return (\n        <div className=\"py-4\">\n            <DndContext onDragEnd={handleDragEnd} collisionDetection={closestCenter}>\n                <div className=\"space-y-8\">\n                     <div>\n                        <div className=\"flex justify-between items-center mb-4\">\n                           <h2 className=\"font-headline text-2xl text-glow\">Deck Analysis</h2>\n                           <Button onClick={handleSaveDeck} disabled={isSaving || deck.length !== DECK_SIZE}>\n                                {isSaving ? <Loader2 className=\"animate-spin\" /> : <Save />} Save Deck\n                            </Button>\n                        </div>\n                        \n                        {deck.length !== DECK_SIZE && (\n                            <Alert variant=\"destructive\" className=\"mb-4\">\n                                <AlertCircle className=\"h-4 w-4\" />\n                                <AlertTitle>Deck Invalid</AlertTitle>\n                                <AlertDescription>\n                                    Your deck has {deck.length} cards. It must have exactly {DECK_SIZE} cards to be valid.\n                                </AlertDescription>\n                            </Alert>\n                        )}\n                        <DeckStats cards={deckCardsData} />\n                    </div>\n\n\n                    <Card id=\"deck-droppable\" className=\"min-h-96\">\n                        <CardHeader>\n                            <CardTitle>Your Deck ({deck.length}/{DECK_SIZE})</CardTitle>\n                            <CardDescription>This is your active deck for battles. Drag and drop cards to customize it.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"flex flex-wrap gap-4 p-4 bg-muted/20 rounded-lg min-h-[22rem]\">\n                            <SortableContext items={deck} strategy={rectSortingStrategy}>\n                                {deck.map(cardName => {\n                                    const cardData = collectionState.find(c => c.name === cardName);\n                                    return cardData ? <DraggableCard key={cardName} card={cardData} inDeck={true} /> : null;\n                                })}\n                            </SortableContext>\n                        </CardContent>\n                    </Card>\n\n                    <Card id=\"collection-droppable\" className=\"min-h-96\">\n                        <CardHeader>\n                            <CardTitle>Your Collection</CardTitle>\n                            <CardDescription>These are all the cards you own. Drag cards into your deck above.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"flex flex-wrap gap-4 p-4 bg-background/50 rounded-lg\">\n                            <SortableContext items={collectionPool.map(c => c.name)} strategy={rectSortingStrategy}>\n                                {collectionPool.map(card => (\n                                <DraggableCard key={card.id} card={card} inDeck={false} />\n                                ))}\n                            </SortableContext>\n                        </CardContent>\n                    </Card>\n                </div>\n            </DndContext>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2141, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/transmute-item-flow.ts"],"sourcesContent":["\n'use server';\n/**\n * @fileOverview This file defines the Genkit flow for generating a new card by transmuting a junk item.\n *\n * - transmuteItemToCard - A function that creates a new, unique card based on a junk item and player context.\n */\n\nimport { ai } from '@/ai/genkit';\nimport { z } from 'zod';\n\nconst TransmuteItemInputSchema = z.object({\n    playerClass: z.string().describe('The class of the player character (e.g., \"Sneaky Rogue\").'),\n    playerLevel: z.number().describe('The current level of the player.'),\n    existingCards: z.array(z.string()).describe('A list of card names the player already owns to ensure variety.'),\n    itemName: z.string().describe('The name of the junk item being transmuted.'),\n    itemDescription: z.string().describe('The description of the junk item being transmuted.'),\n});\n\nconst TransmuteItemOutputSchema = z.object({\n    name: z.string().describe('The creative and thematic name of the new card. Should be unique and inspired by the item.'),\n    description: z.string().describe(\"A flavorful and clear description of what the card does.\"),\n    manaCost: z.number().min(0).max(8).describe('The mana cost to play the card. Should be balanced with its effect.'),\n    attack: z.number().min(0).describe('The attack power of the card. 0 if it does not attack.'),\n    defense: z.number().min(0).describe('The defense value of the card. 0 if it does not grant defense.'),\n    healing: z.number().min(0).describe('The healing value of the card. 0 if it does not heal.'),\n});\nexport type TransmuteItemOutput = z.infer<typeof TransmuteItemOutputSchema>;\n\n\nexport async function transmuteItemToCard(input: z.infer<typeof TransmuteItemInputSchema>): Promise<TransmuteItemOutput> {\n    return transmuteItemFlow(input);\n}\n\n\nconst transmuteItemPrompt = ai.definePrompt({\n    name: 'transmuteItemPrompt',\n    input: { schema: TransmuteItemInputSchema },\n    output: { schema: TransmuteItemOutputSchema },\n    prompt: `You are the AI Alchemist for Poot Quest, a master of turning useless junk into powerful, thematic, and slightly absurd abilities.\n\n    **Player Context:**\n    - Class: {{playerClass}}\n    - Level: {{playerLevel}}\n    - Existing Cards: {{#each existingCards}}, {{this}}{{/each}}\n    \n    **Item to Transmute:**\n    - Name: {{itemName}}\n    - Description: {{itemDescription}}\n\n    **Your Task:**\n    Transmute the junk item into a brand new, unique card that is thematically inspired by the item and suited for the player's class.\n\n    **Card Generation Rules:**\n    1.  **Thematic Inspiration:** The card's name, description, and effect MUST be inspired by the junk item's name ('{{itemName}}') and description.\n    2.  **Class Synergy:** The card must fit the playstyle of the **{{playerClass}}**. A \"Paladin of Purity\" should get a defensive or healing card, while a \"Sneaky Rogue\" should get an attack or utility card.\n    3.  **Balanced:** The card's power must be appropriate for a level **{{playerLevel}}** character. Balance the mana cost against the effect.\n    4.  **Unique Name:** The card name must NOT be one of the following: {{#each existingCards}}\"{{this}}\", {{/each}}.\n    5.  **Specific Effects:** The card should have a clear purpose. Define at least one non-zero value for attack, defense, or healing.\n\n    **Example Transmutation:**\n    - Item Name: \"A Goblin's Rusty Spoon\"\n    - Item Description: \"A bent and tarnished spoon, probably used for eating something awful.\"\n    - Player Class: \"Sneaky Rogue\"\n    - Result:\n    {\n      \"name\": \"Rusty Shank\",\n      \"description\": \"Fashion a shiv from the spoon. A quick, cheap shot that can cause a nasty infection.\",\n      \"manaCost\": 1,\n      \"attack\": 4,\n      \"defense\": 0,\n      \"healing\": 0\n    }\n\n    **Example Transmutation 2:**\n    - Item Name: \"A Skeletal Finger\"\n    - Item Description: \"A surprisingly well-preserved finger bone. It seems to point accusingly.\"\n    - Player Class: \"Paladin of Purity\"\n    - Result:\n    {\n        \"name\": \"Bone Shield\",\n        \"description\": \"Raise the finger bone to create a surprisingly sturdy, if unsettling, barrier.\",\n        \"manaCost\": 2,\n        \"attack\": 0,\n        \"defense\": 8,\n        \"healing\": 0\n    }\n\n    Now, transmute the junk item for the **{{playerClass}}**.`\n});\n\n\nconst transmuteItemFlow = ai.defineFlow(\n    {\n        name: 'transmuteItemFlow',\n        inputSchema: TransmuteItemInputSchema,\n        outputSchema: TransmuteItemOutputSchema,\n    },\n    async (input) => {\n        const { output } = await transmuteItemPrompt(input);\n        return output!;\n    }\n);\n"],"names":[],"mappings":";;;;;;IA8BsB,sBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 2154, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/sheets/InventorySheet.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState } from 'react';\nimport { useFirebase, useCollection, useDoc, useMemoFirebase } from '@/firebase';\nimport { writeBatch, doc, collection } from 'firebase/firestore';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Loader2, Wand2, Sparkles, HelpCircle } from 'lucide-react';\nimport { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';\nimport { useToast } from '@/hooks/use-toast';\nimport { transmuteItemToCard, TransmuteItemOutput } from '@/ai/flows/transmute-item-flow';\nimport { CARD_DATA, getClass } from '@/lib/game-data';\n\nconst ItemCard = ({ item, onTransmute, isTransmuting }: { item: any, onTransmute: (item: any) => void, isTransmuting: boolean }) => {\n    const canBeTransmuted = item.type === 'junk';\n    return (\n        <Card className=\"w-48 h-64 flex flex-col p-3 text-center bg-secondary/50\">\n            <CardHeader className=\"p-2\">\n                <CardTitle className=\"text-lg\">{item.name}</CardTitle>\n                <CardDescription className=\"text-xs italic h-10 overflow-hidden\">{item.description}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"flex-grow flex items-center justify-center\">\n                <HelpCircle className=\"h-16 w-16 text-primary/50\" />\n            </CardContent>\n            {canBeTransmuted && (\n                <Button onClick={() => onTransmute(item)} disabled={isTransmuting}>\n                    {isTransmuting ? <Loader2 className=\"animate-spin\" /> : <><Wand2 className=\"mr-2\" />Transmute</>}\n                </Button>\n            )}\n        </Card>\n    );\n};\n\nconst NewCard = ({ card }: { card: TransmuteItemOutput }) => (\n     <Card className=\"w-48 h-64 flex flex-col p-3 text-center bg-green-900/50 border-green-500\">\n        <CardHeader className=\"p-2\">\n            <CardTitle className=\"text-lg text-green-300\">{card.name}</CardTitle>\n            <CardDescription className=\"text-xs italic\">{card.description}</CardDescription>\n        </CardHeader>\n        <CardContent className=\"flex-grow flex flex-col justify-center items-center text-sm space-y-1\">\n            <p className=\"text-muted-foreground\">Cost: {card.manaCost}</p>\n            {card.attack > 0 && <p>ATK: {card.attack}</p>}\n            {card.defense > 0 && <p>DEF: {card.defense}</p>}\n            {card.healing > 0 && <p>HEAL: {card.healing}</p>}\n        </CardContent>\n    </Card>\n)\n\nexport function InventorySheet({ characterId }: { characterId: string }) {\n    const { firestore, user, isUserLoading } = useFirebase();\n    const { toast } = useToast();\n\n    const [isTransmuting, setIsTransmuting] = useState<string | null>(null);\n    const [newlyCreatedCard, setNewlyCreatedCard] = useState<TransmuteItemOutput | null>(null);\n\n    const inventoryRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return collection(firestore, `users/${user.uid}/characters/${characterId}/inventory`);\n    }, [firestore, user, characterId]);\n    \n    const characterRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}`);\n    }, [firestore, user, characterId]);\n\n    const { data: inventoryData, isLoading: isInventoryLoading } = useCollection(inventoryRef);\n    const { data: characterData, isLoading: isCharacterLoading } = useDoc(characterRef);\n    \n    const deckRef = useMemoFirebase(() => {\n        if (!firestore || !user) return null;\n        return doc(firestore, `users/${user.uid}/characters/${characterId}/decks`, \"main\");\n    }, [firestore, user, characterId]);\n    \n    const { data: deckData, isLoading: isDeckLoading } = useDoc(deckRef);\n\n    const handleTransmuteItem = async (itemToTransmute: any) => {\n        if (!firestore || !user || !characterData || !deckData || !inventoryData) return;\n        setIsTransmuting(itemToTransmute.id);\n        setNewlyCreatedCard(null);\n\n        const characterClass = getClass(characterData?.class);\n        \n        if (!characterData || !characterClass || !deckData) {\n             toast({ title: \"Error\", description: \"Could not find character data to generate card.\", variant: \"destructive\" });\n             setIsTransmuting(null);\n             return;\n        }\n\n        try {\n            const inventoryCardNames = inventoryData.filter(item => item.type === 'card').map(item => item.name);\n            const starterCardNames = characterClass.starterDeck.map(c => c.name);\n            const allOwnedCards = Array.from(new Set([...deckData.cards, ...Object.keys(CARD_DATA), ...inventoryCardNames, ...starterCardNames]));\n            \n            const newCard = await transmuteItemToCard({\n                playerClass: characterClass.name,\n                playerLevel: characterData.level,\n                existingCards: allOwnedCards,\n                itemName: itemToTransmute.name,\n                itemDescription: itemToTransmute.description,\n            });\n\n            const batch = writeBatch(firestore);\n            \n            // Delete the junk item\n            const itemToDeleteRef = doc(inventoryRef!, itemToTransmute.id);\n            batch.delete(itemToDeleteRef);\n            \n            // Add the new card to the inventory (it is now an item of type 'card')\n            const newCardItemRef = doc(collection(firestore, `users/${user.uid}/characters/${characterId}/inventory`));\n            batch.set(newCardItemRef, { ...newCard, type: 'card' });\n\n            await batch.commit();\n\n            setNewlyCreatedCard(newCard);\n            toast({ title: \"Transmutation Successful!\", description: `Your ${itemToTransmute.name} became \"${newCard.name}\"!`, className: 'bg-primary text-primary-foreground' });\n\n        } catch (error) {\n            console.error(\"Failed to transmute item:\", error);\n            toast({ title: \"AI Error\", description: \"The item fizzled into dust. Please try again with another.\", variant: \"destructive\" });\n        } finally {\n            setIsTransmuting(null);\n        }\n    };\n    \n    const isLoading = isUserLoading || isInventoryLoading || isCharacterLoading || isDeckLoading;\n\n    if (isLoading) {\n        return (\n            <div className=\"flex h-screen items-center justify-center\">\n                <Loader2 className=\"h-16 w-16 animate-spin text-primary\" />\n            </div>\n        );\n    }\n    \n    const junkItems = inventoryData?.filter(item => item.type === 'junk') || [];\n    const cardItems = inventoryData?.filter(item => item.type === 'card') || [];\n    \n    return (\n        <div className=\"py-4\">\n            <div className=\"space-y-8\">\n                {newlyCreatedCard && (\n                    <Alert variant=\"default\" className=\"border-green-500/50 bg-green-900/30\">\n                        <Sparkles className=\"h-4 w-4 text-green-400\" />\n                        <AlertTitle className=\"text-green-300\">New Card Created!</AlertTitle>\n                        <AlertDescription className=\"flex items-center gap-4\">\n                           <p> The item was transmuted successfully. The \"{newlyCreatedCard.name}\" card has been added to your collection and can now be added to your deck.</p>\n                           <NewCard card={newlyCreatedCard} />\n                        </AlertDescription>\n                    </Alert>\n                )}\n\n                <Card>\n                    <CardHeader>\n                        <CardTitle>Your Junk</CardTitle>\n                        <CardDescription>These are the useless but potentially magical items you've collected. Try transmuting them!</CardDescription>\n                    </CardHeader>\n                    <CardContent className=\"flex flex-wrap gap-4 p-4 bg-muted/20 rounded-lg min-h-64\">\n                       {junkItems.length > 0 ? (\n                           junkItems.map(item => (\n                               <ItemCard \n                                    key={item.id} \n                                    item={item} \n                                    onTransmute={handleTransmuteItem} \n                                    isTransmuting={isTransmuting === item.id} \n                                />\n                           ))\n                       ) : (\n                           <p className=\"text-muted-foreground p-4\">You have no junk to transmute. Go find some!</p>\n                       )}\n                    </CardContent>\n                </Card>\n\n                 <Card>\n                    <CardHeader>\n                        <CardTitle>Your Discovered Cards</CardTitle>\n                        <CardDescription>These are cards you have transmuted. Manage them in your deck.</CardDescription>\n                    </CardHeader>\n                    <CardContent className=\"flex flex-wrap gap-4 p-4 bg-muted/20 rounded-lg min-h-24\">\n                       {cardItems.length > 0 ? (\n                           cardItems.map(item => (\n                               <NewCard \n                                    key={item.id} \n                                    card={item as TransmuteItemOutput} \n                                />\n                           ))\n                       ) : (\n                           <p className=\"text-muted-foreground p-4\">You haven't transmuted any cards yet.</p>\n                       )}\n                    </CardContent>\n                </Card>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAXA;;;;;;;;;;;;AAaA,MAAM,WAAW,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,aAAa,EAA2E;IAC3H,MAAM,kBAAkB,KAAK,IAAI,KAAK;IACtC,qBACI,8OAAC,gIAAA,CAAA,OAAI;QAAC,WAAU;;0BACZ,8OAAC,gIAAA,CAAA,aAAU;gBAAC,WAAU;;kCAClB,8OAAC,gIAAA,CAAA,YAAS;wBAAC,WAAU;kCAAW,KAAK,IAAI;;;;;;kCACzC,8OAAC,gIAAA,CAAA,kBAAe;wBAAC,WAAU;kCAAuC,KAAK,WAAW;;;;;;;;;;;;0BAEtF,8OAAC,gIAAA,CAAA,cAAW;gBAAC,WAAU;0BACnB,cAAA,8OAAC,kNAAA,CAAA,aAAU;oBAAC,WAAU;;;;;;;;;;;YAEzB,iCACG,8OAAC,kIAAA,CAAA,SAAM;gBAAC,SAAS,IAAM,YAAY;gBAAO,UAAU;0BAC/C,8BAAgB,8OAAC,iNAAA,CAAA,UAAO;oBAAC,WAAU;;;;;yCAAoB;;sCAAE,8OAAC,+MAAA,CAAA,QAAK;4BAAC,WAAU;;;;;;wBAAS;;;;;;;;;;;;;;AAKxG;AAEA,MAAM,UAAU,CAAC,EAAE,IAAI,EAAiC,iBACnD,8OAAC,gIAAA,CAAA,OAAI;QAAC,WAAU;;0BACb,8OAAC,gIAAA,CAAA,aAAU;gBAAC,WAAU;;kCAClB,8OAAC,gIAAA,CAAA,YAAS;wBAAC,WAAU;kCAA0B,KAAK,IAAI;;;;;;kCACxD,8OAAC,gIAAA,CAAA,kBAAe;wBAAC,WAAU;kCAAkB,KAAK,WAAW;;;;;;;;;;;;0BAEjE,8OAAC,gIAAA,CAAA,cAAW;gBAAC,WAAU;;kCACnB,8OAAC;wBAAE,WAAU;;4BAAwB;4BAAO,KAAK,QAAQ;;;;;;;oBACxD,KAAK,MAAM,GAAG,mBAAK,8OAAC;;4BAAE;4BAAM,KAAK,MAAM;;;;;;;oBACvC,KAAK,OAAO,GAAG,mBAAK,8OAAC;;4BAAE;4BAAM,KAAK,OAAO;;;;;;;oBACzC,KAAK,OAAO,GAAG,mBAAK,8OAAC;;4BAAE;4BAAO,KAAK,OAAO;;;;;;;;;;;;;;;;;;;AAKhD,SAAS,eAAe,EAAE,WAAW,EAA2B;IACnE,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,CAAA,GAAA,4HAAA,CAAA,cAAW,AAAD;IACrD,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD;IAEzB,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA8B;IAErF,MAAM,eAAe,CAAA,GAAA,4HAAA,CAAA,kBAAe,AAAD,EAAE;QACjC,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;QAChC,OAAO,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,YAAY,EAAE,YAAY,UAAU,CAAC;IACxF,GAAG;QAAC;QAAW;QAAM;KAAY;IAEjC,MAAM,eAAe,CAAA,GAAA,4HAAA,CAAA,kBAAe,AAAD,EAAE;QACjC,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;QAChC,OAAO,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,YAAY,EAAE,aAAa;IACvE,GAAG;QAAC;QAAW;QAAM;KAAY;IAEjC,MAAM,EAAE,MAAM,aAAa,EAAE,WAAW,kBAAkB,EAAE,GAAG,CAAA,GAAA,kJAAA,CAAA,gBAAa,AAAD,EAAE;IAC7E,MAAM,EAAE,MAAM,aAAa,EAAE,WAAW,kBAAkB,EAAE,GAAG,CAAA,GAAA,2IAAA,CAAA,SAAM,AAAD,EAAE;IAEtE,MAAM,UAAU,CAAA,GAAA,4HAAA,CAAA,kBAAe,AAAD,EAAE;QAC5B,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;QAChC,OAAO,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,YAAY,EAAE,YAAY,MAAM,CAAC,EAAE;IAC/E,GAAG;QAAC;QAAW;QAAM;KAAY;IAEjC,MAAM,EAAE,MAAM,QAAQ,EAAE,WAAW,aAAa,EAAE,GAAG,CAAA,GAAA,2IAAA,CAAA,SAAM,AAAD,EAAE;IAE5D,MAAM,sBAAsB,OAAO;QAC/B,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC,YAAY,CAAC,eAAe;QAC1E,iBAAiB,gBAAgB,EAAE;QACnC,oBAAoB;QAEpB,MAAM,iBAAiB,CAAA,GAAA,0HAAA,CAAA,WAAQ,AAAD,EAAE,eAAe;QAE/C,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,UAAU;YAC/C,MAAM;gBAAE,OAAO;gBAAS,aAAa;gBAAmD,SAAS;YAAc;YAC/G,iBAAiB;YACjB;QACL;QAEA,IAAI;YACA,MAAM,qBAAqB,cAAc,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI,KAAK,QAAQ,GAAG,CAAC,CAAA,OAAQ,KAAK,IAAI;YACnG,MAAM,mBAAmB,eAAe,WAAW,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI;YACnE,MAAM,gBAAgB,MAAM,IAAI,CAAC,IAAI,IAAI;mBAAI,SAAS,KAAK;mBAAK,OAAO,IAAI,CAAC,0HAAA,CAAA,YAAS;mBAAM;mBAAuB;aAAiB;YAEnI,MAAM,UAAU,MAAM,CAAA,GAAA,0JAAA,CAAA,sBAAmB,AAAD,EAAE;gBACtC,aAAa,eAAe,IAAI;gBAChC,aAAa,cAAc,KAAK;gBAChC,eAAe;gBACf,UAAU,gBAAgB,IAAI;gBAC9B,iBAAiB,gBAAgB,WAAW;YAChD;YAEA,MAAM,QAAQ,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE;YAEzB,uBAAuB;YACvB,MAAM,kBAAkB,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,cAAe,gBAAgB,EAAE;YAC7D,MAAM,MAAM,CAAC;YAEb,uEAAuE;YACvE,MAAM,iBAAiB,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,YAAY,EAAE,YAAY,UAAU,CAAC;YACxG,MAAM,GAAG,CAAC,gBAAgB;gBAAE,GAAG,OAAO;gBAAE,MAAM;YAAO;YAErD,MAAM,MAAM,MAAM;YAElB,oBAAoB;YACpB,MAAM;gBAAE,OAAO;gBAA6B,aAAa,CAAC,KAAK,EAAE,gBAAgB,IAAI,CAAC,SAAS,EAAE,QAAQ,IAAI,CAAC,EAAE,CAAC;gBAAE,WAAW;YAAqC;QAEvK,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;gBAAE,OAAO;gBAAY,aAAa;gBAA8D,SAAS;YAAc;QACjI,SAAU;YACN,iBAAiB;QACrB;IACJ;IAEA,MAAM,YAAY,iBAAiB,sBAAsB,sBAAsB;IAE/E,IAAI,WAAW;QACX,qBACI,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC,iNAAA,CAAA,UAAO;gBAAC,WAAU;;;;;;;;;;;IAG/B;IAEA,MAAM,YAAY,eAAe,OAAO,CAAA,OAAQ,KAAK,IAAI,KAAK,WAAW,EAAE;IAC3E,MAAM,YAAY,eAAe,OAAO,CAAA,OAAQ,KAAK,IAAI,KAAK,WAAW,EAAE;IAE3E,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;gBACV,kCACG,8OAAC,iIAAA,CAAA,QAAK;oBAAC,SAAQ;oBAAU,WAAU;;sCAC/B,8OAAC,0MAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;sCACpB,8OAAC,iIAAA,CAAA,aAAU;4BAAC,WAAU;sCAAiB;;;;;;sCACvC,8OAAC,iIAAA,CAAA,mBAAgB;4BAAC,WAAU;;8CACzB,8OAAC;;wCAAE;wCAA6C,iBAAiB,IAAI;wCAAC;;;;;;;8CACtE,8OAAC;oCAAQ,MAAM;;;;;;;;;;;;;;;;;;8BAK1B,8OAAC,gIAAA,CAAA,OAAI;;sCACD,8OAAC,gIAAA,CAAA,aAAU;;8CACP,8OAAC,gIAAA,CAAA,YAAS;8CAAC;;;;;;8CACX,8OAAC,gIAAA,CAAA,kBAAe;8CAAC;;;;;;;;;;;;sCAErB,8OAAC,gIAAA,CAAA,cAAW;4BAAC,WAAU;sCACnB,UAAU,MAAM,GAAG,IAChB,UAAU,GAAG,CAAC,CAAA,qBACV,8OAAC;oCAEI,MAAM;oCACN,aAAa;oCACb,eAAe,kBAAkB,KAAK,EAAE;mCAHnC,KAAK,EAAE;;;;0DAOrB,8OAAC;gCAAE,WAAU;0CAA4B;;;;;;;;;;;;;;;;;8BAKnD,8OAAC,gIAAA,CAAA,OAAI;;sCACF,8OAAC,gIAAA,CAAA,aAAU;;8CACP,8OAAC,gIAAA,CAAA,YAAS;8CAAC;;;;;;8CACX,8OAAC,gIAAA,CAAA,kBAAe;8CAAC;;;;;;;;;;;;sCAErB,8OAAC,gIAAA,CAAA,cAAW;4BAAC,WAAU;sCACnB,UAAU,MAAM,GAAG,IAChB,UAAU,GAAG,CAAC,CAAA,qBACV,8OAAC;oCAEI,MAAM;mCADD,KAAK,EAAE;;;;0DAKrB,8OAAC;gCAAE,WAAU;0CAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOpE","debugId":null}},
    {"offset": {"line": 2636, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/AdventureClient.tsx"],"sourcesContent":["\n\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, BookOpen, Forward, ChevronRight, Briefcase, Scroll, Shield, Swords, Ghost } from \"lucide-react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { useCharacter } from \"@/hooks/useCharacter\";\nimport { useNarrative } from \"@/hooks/useNarrative\";\nimport { Sheet, SheetContent, SheetHeader, SheetTitle, SheetTrigger } from \"@/components/ui/sheet\";\nimport { DeckManagerSheet } from \"./sheets/DeckManagerSheet\";\nimport { InventorySheet } from \"./sheets/InventorySheet\";\nimport { cn } from \"@/lib/utils\";\n\ninterface AdventureClientProps {\n  characterId: string;\n  initialBattleState?: any;\n}\n\nconst GeneratingState = () => {\n    const icons = [Swords, Shield, Ghost, BookOpen];\n    const [animatedIcons, setAnimatedIcons] = useState<any[]>([]);\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            setAnimatedIcons(prev => {\n                const newIcon = {\n                    id: Date.now() + Math.random(),\n                    Icon: icons[Math.floor(Math.random() * icons.length)],\n                    style: {\n                        left: `${Math.random() * 90 + 5}%`,\n                        animationDuration: `${Math.random() * 5 + 3}s`,\n                    },\n                };\n                return [...prev, newIcon].slice(-15); // Keep the last 15 icons\n            });\n        }, 500);\n\n        return () => clearInterval(interval);\n    }, []);\n\n    return (\n        <div className=\"flex flex-col items-center justify-center text-center h-64 relative overflow-hidden\">\n            <style jsx>{`\n                @keyframes float-up {\n                    from {\n                        transform: translateY(100px);\n                        opacity: 0;\n                    }\n                    to {\n                        transform: translateY(-100px);\n                        opacity: 1;\n                    }\n                }\n                .floating-icon {\n                    position: absolute;\n                    animation-name: float-up;\n                    animation-timing-function: ease-in-out;\n                    animation-iteration-count: 1;\n                    opacity: 0;\n                    animation-fill-mode: forwards;\n                }\n            `}</style>\n            \n            {animatedIcons.map(({ id, Icon, style }) => (\n                <Icon key={id} className=\"floating-icon text-primary/30\" style={style} />\n            ))}\n\n            <div className=\"z-10 bg-background/50 p-4 rounded-lg\">\n                <Loader2 className=\"h-12 w-12 animate-spin text-primary mb-4 mx-auto\" />\n                <p className=\"text-xl text-muted-foreground font-headline\">\n                    The Fartmaster is weaving your fate...\n                </p>\n            </div>\n        </div>\n    );\n};\n\n\nexport function AdventureClient({ characterId, initialBattleState }: AdventureClientProps) {\n  const { character, characterClassData, isLoading: isCharacterLoading } = useCharacter(characterId);\n  const { \n    narrativeContext, \n    gameState, \n    error, \n    handleContinue, \n    handleChoice,\n    isLoading: isNarrativeLoading \n  } = useNarrative(characterId, character, characterClassData, initialBattleState);\n  \n  const isLoading = isCharacterLoading || isNarrativeLoading;\n  const currentScenario = narrativeContext?.currentScenario;\n\n  const renderContent = () => {\n    if (isLoading && gameState === 'loading') {\n      return (\n        <div className=\"flex flex-col items-center justify-center text-center h-64\">\n          <Loader2 className=\"h-16 w-16 animate-spin text-primary mb-4\" />\n          <p className=\"text-xl text-muted-foreground font-headline\">Loading your legend...</p>\n        </div>\n      );\n    }\n\n    if (error) {\n        return (\n          <Alert variant=\"destructive\">\n            <AlertTitle>AI Error</AlertTitle>\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        );\n    }\n    \n    if (gameState === 'generating') {\n         return <GeneratingState />;\n    }\n    \n    if (gameState === \"ready\" && currentScenario) {\n      return (\n        <div className=\"space-y-8\">\n          <div className=\"text-lg leading-relaxed whitespace-pre-wrap p-6 bg-background/50 rounded-lg border border-border/50 font-serif italic\">\n            {currentScenario.scenarioText}\n          </div>\n          <div className=\"space-y-4\">\n            <h3 className=\"text-center font-headline text-2xl text-glow\">What do you do?</h3>\n            {currentScenario.choices.map((choice) => (\n              <Button\n                key={choice.id}\n                onClick={() => handleChoice(choice)}\n                className=\"w-full justify-between h-auto py-3 px-4 text-left\"\n                variant=\"outline\"\n                size=\"lg\"\n              >\n                <span className=\"font-bold mr-4\">{choice.id}.</span> \n                <span className=\"flex-1 whitespace-normal\">{choice.text}</span>\n                <ChevronRight className=\"h-5 w-5 ml-4\" />\n              </Button>\n            ))}\n          </div>\n        </div>\n      );\n    }\n    \n    if (gameState === \"awaiting_continue\" && narrativeContext) {\n      return (\n        <div className=\"space-y-6 text-center\">\n          <div className=\"p-4 bg-muted rounded-lg border border-border\">\n            <h3 className=\"font-headline text-lg text-accent flex items-center justify-center gap-2\">\n              <BookOpen /> Your Story Arc\n            </h3>\n            <p className=\"text-muted-foreground italic mt-2\">\n              &quot;{narrativeContext.storyArc}&quot;\n            </p>\n          </div>\n          {narrativeContext.lastNarration && (\n            <p className=\"text-lg leading-relaxed whitespace-pre-wrap font-serif min-h-[6rem] p-4 bg-background/30 rounded-md\">\n              {narrativeContext.lastNarration}\n            </p>\n          )}\n          <div className=\"flex gap-4 justify-center\">\n            <Button onClick={handleContinue} size=\"lg\" disabled={gameState === 'generating'}>\n              Continue Your Adventure <Forward className=\"ml-2 h-4 w-4\" />\n            </Button>\n            <Sheet>\n                <SheetTrigger asChild>\n                    <Button variant=\"outline\" size=\"lg\">\n                        <Briefcase className=\"mr-2 h-4 w-4\" /> Manage Deck\n                    </Button>\n                </SheetTrigger>\n                <SheetContent side=\"right\" className=\"w-full sm:max-w-4xl overflow-y-auto\">\n                    <SheetHeader>\n                        <SheetTitle className=\"font-headline text-3xl text-glow\">Deck Manager</SheetTitle>\n                    </SheetHeader>\n                    <DeckManagerSheet characterId={characterId} />\n                </SheetContent>\n            </Sheet>\n            <Sheet>\n                <SheetTrigger asChild>\n                    <Button variant=\"outline\" size=\"lg\">\n                        <Scroll className=\"mr-2 h-4 w-4\" /> Inspect Inventory\n                    </Button>\n                </SheetTrigger>\n                 <SheetContent side=\"right\" className=\"w-full sm:max-w-3xl overflow-y-auto\">\n                    <SheetHeader>\n                        <SheetTitle className=\"font-headline text-3xl text-glow\">Inventory</SheetTitle>\n                    </SheetHeader>\n                    <InventorySheet characterId={characterId} />\n                </SheetContent>\n            </Sheet>\n          </div>\n        </div>\n      );\n    }\n    \n    return (\n      <div className=\"flex flex-col items-center justify-center text-center h-64\">\n        <Loader2 className=\"h-16 w-16 animate-spin text-primary mb-4\" />\n        <p className=\"text-xl text-muted-foreground font-headline\">Loading your legend...</p>\n      </div>\n    );\n  };\n\n\n  return (\n    <Card className=\"max-w-3xl mx-auto shadow-lg shadow-primary/10 border-primary/20\">\n      <CardHeader className=\"text-center\">\n        <CardTitle className=\"font-headline text-3xl text-glow\">\n          {characterClassData?.name || \"The Adventure\"}\n        </CardTitle>\n        <div className=\"flex justify-center items-center gap-6 text-muted-foreground\">\n            <span>{narrativeContext?.location || \"A mysterious place...\"}</span>\n            <Separator orientation=\"vertical\" className=\"h-4\" />\n             <div className=\"flex items-center gap-4\">\n                <TooltipProvider>\n                    <Tooltip>\n                        <TooltipTrigger className=\"flex items-center gap-1\">\n                            <Ghost className=\"h-4 w-4 text-gray-400\" /> {narrativeContext?.reputationStealth || 0}\n                        </TooltipTrigger>\n                        <TooltipContent><p>Stealth Reputation</p></TooltipContent>\n                    </Tooltip>\n                    <Tooltip>\n                        <TooltipTrigger className=\"flex items-center gap-1\">\n                            <Swords className=\"h-4 w-4 text-red-400\" /> {narrativeContext?.reputationCombat || 0}\n                        </TooltipTrigger>\n                        <TooltipContent><p>Combat Reputation</p></TooltipContent>\n                    </Tooltip>\n                    <Tooltip>\n                        <TooltipTrigger className=\"flex items-center gap-1\">\n                            <Shield className=\"h-4 w-4 text-blue-400\" /> {narrativeContext?.reputationDiplomacy || 0}\n                        </TooltipTrigger>\n                        <TooltipContent><p>Diplomacy Reputation</p></TooltipContent>\n                    </Tooltip>\n                </TooltipProvider>\n            </div>\n        </div>\n      </CardHeader>\n      <Separator />\n      <CardContent className=\"p-4 sm:p-6\">{renderContent()}</CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3325, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/GameContainer.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\";\nimport type { ReactNode } from \"react\";\n\nexport function GameContainer({ children, className }: { children: ReactNode, className?: string }) {\n  return (\n    <div className={cn(\"container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8\", className)}>\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAGO,SAAS,cAAc,EAAE,QAAQ,EAAE,SAAS,EAA+C;IAChG,qBACE,8OAAC;QAAI,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,yDAAyD;kBACzE;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 3348, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,8OAAC;QAAI,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE","debugId":null}},
    {"offset": {"line": 3390, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/store/StoreSheet.tsx"],"sourcesContent":["\n'use client';\n\nimport Image from 'next/image';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetTrigger } from '@/components/ui/sheet';\nimport { useCollection, useFirebase, useMemoFirebase } from '@/firebase';\nimport { collection, query } from 'firebase/firestore';\nimport { Loader2, ShoppingBag, ExternalLink, Zap } from 'lucide-react';\nimport { Badge } from '../ui/badge';\n\ntype Product = {\n    id: string;\n    title: string;\n    description: string;\n    price: number;\n    imageUrl: string;\n    imageHint: string;\n    stripePaymentLink: string;\n    status: 'available' | 'limited' | 'sold_out';\n};\n\nconst ProductCard = ({ product }: { product: Product }) => (\n    <Card className=\"flex flex-col bg-card/80 border border-border/50 overflow-hidden\">\n        <div className=\"relative aspect-video\">\n            <Image\n                src={product.imageUrl}\n                alt={product.title}\n                fill\n                className=\"object-cover\"\n                data-ai-hint={product.imageHint}\n            />\n            {product.status === 'limited' && (\n                <Badge variant=\"destructive\" className=\"absolute top-2 right-2 animate-pulse gap-1\">\n                    <Zap className=\"h-3 w-3\" /> Limited Drop\n                </Badge>\n            )}\n        </div>\n        <CardHeader>\n            <CardTitle className=\"font-headline text-xl text-glow\">{product.title}</CardTitle>\n            <CardDescription>{product.description}</CardDescription>\n        </CardHeader>\n        <CardContent className=\"flex-grow\" />\n        <CardFooter className=\"flex justify-between items-center\">\n            <p className=\"text-2xl font-bold font-code text-primary\">${product.price.toFixed(2)}</p>\n            <Button asChild disabled={product.status === 'sold_out'}>\n                <a href={product.stripePaymentLink} target=\"_blank\" rel=\"noopener noreferrer\">\n                    {product.status === 'sold_out' ? 'Sold Out' : 'Buy Now'}\n                    <ExternalLink className=\"ml-2\" />\n                </a>\n            </Button>\n        </CardFooter>\n    </Card>\n);\n\nexport function StoreSheet() {\n    const { firestore } = useFirebase();\n\n    const productsQuery = useMemoFirebase(() => {\n        if (!firestore) return null;\n        return query(collection(firestore, 'products'));\n    }, [firestore]);\n\n    const { data: products, isLoading } = useCollection(productsQuery);\n\n    return (\n        <Sheet>\n            <SheetTrigger asChild>\n                <Button variant=\"outline\" size=\"icon\" className=\"relative group\">\n                    <ShoppingBag />\n                    <span className=\"sr-only\">Open Store</span>\n                    <span className=\"absolute -top-1 -right-1 flex h-3 w-3\">\n                        <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75\"></span>\n                        <span className=\"relative inline-flex rounded-full h-3 w-3 bg-primary/80\"></span>\n                    </span>\n                </Button>\n            </SheetTrigger>\n            <SheetContent side=\"right\" className=\"w-full sm:max-w-3xl overflow-y-auto\">\n                <SheetHeader>\n                    <SheetTitle className=\"font-headline text-4xl text-glow flex items-center gap-2\">\n                        <ShoppingBag className=\"h-8 w-8\" />\n                        The Emporium\n                    </SheetTitle>\n                    <SheetDescription>\n                        Grab some legendary loot from the real world. Ships worldwide!\n                    </SheetDescription>\n                </SheetHeader>\n                <div className=\"py-8\">\n                    {isLoading ? (\n                        <div className=\"flex justify-center items-center h-64\">\n                            <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n                        </div>\n                    ) : (\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                            {products?.map((product) => (\n                                <ProductCard key={product.id} product={product as Product} />\n                            ))}\n                        </div>\n                    )}\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3696, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/Header.tsx"],"sourcesContent":["\n\nimport Link from \"next/link\";\nimport { Swords, Coffee, BookOpen, ShoppingBag } from \"lucide-react\";\nimport { Button } from \"../ui/button\";\nimport { StoreSheet } from \"../store/StoreSheet\";\n\nexport function Header() {\n  return (\n    <header className=\"py-4 px-4 sm:px-6 lg:px-8 bg-background/80 backdrop-blur-sm sticky top-0 z-40 border-b\">\n      <div className=\"container mx-auto max-w-7xl flex items-center justify-between\">\n        <Link href=\"/\" className=\"flex items-center gap-2\">\n          <Swords className=\"text-primary h-8 w-8\" />\n          <h1 className=\"text-2xl font-headline font-bold text-glow\">\n            Poot Quest\n          </h1>\n        </Link>\n        <nav className=\"flex items-center gap-2\">\n            <Link href=\"/character-creation\" className=\"text-sm font-medium text-muted-foreground hover:text-foreground transition-colors hidden sm:block\">\n                New Game\n            </Link>\n            <Link href=\"/chronicle\" className=\"text-sm font-medium text-muted-foreground hover:text-foreground transition-colors hidden sm:block\">\n                Chronicles\n            </Link>\n            <Button asChild variant=\"ghost\" size=\"sm\" className=\"hidden sm:inline-flex\">\n                <a href=\"https://buymeacoffee.com/harrisonfamilyventures\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <Coffee className=\"mr-2 h-4 w-4\" /> Buy me a Coffee\n                </a>\n            </Button>\n            <StoreSheet />\n        </nav>\n      </div>\n    </header>\n  );\n}\n\n    "],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AACA;;;;;;AAEO,SAAS;IACd,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC,4JAAA,CAAA,UAAI;oBAAC,MAAK;oBAAI,WAAU;;sCACvB,8OAAC,sMAAA,CAAA,SAAM;4BAAC,WAAU;;;;;;sCAClB,8OAAC;4BAAG,WAAU;sCAA6C;;;;;;;;;;;;8BAI7D,8OAAC;oBAAI,WAAU;;sCACX,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;4BAAsB,WAAU;sCAAoG;;;;;;sCAG/I,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;4BAAa,WAAU;sCAAoG;;;;;;sCAGtI,8OAAC,kIAAA,CAAA,SAAM;4BAAC,OAAO;4BAAC,SAAQ;4BAAQ,MAAK;4BAAK,WAAU;sCAChD,cAAA,8OAAC;gCAAE,MAAK;gCAAkD,QAAO;gCAAS,KAAI;;kDAC1E,8OAAC,sMAAA,CAAA,SAAM;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;sCAG3C,8OAAC,yIAAA,CAAA,aAAU;;;;;;;;;;;;;;;;;;;;;;AAKvB","debugId":null}},
    {"offset": {"line": 3820, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/adventure/%5Bclass%5D/page.tsx"],"sourcesContent":["\n'use client';\nimport { AdventureClient } from \"@/components/game/AdventureClient\";\nimport { GameContainer } from \"@/components/game/GameContainer\";\nimport { Header } from \"@/components/game/Header\";\nimport { useSearchParams } from 'next/navigation';\nimport { Suspense, use } from \"react\";\n\ntype Props = {\n  params: Promise<{ class: string }>;\n};\n\nfunction AdventurePageContent({ params }: Props) {\n  const { class: characterId } = use(params);\n  const searchParams = useSearchParams();\n  const battleStateString = searchParams.get('battleState');\n  const initialBattleState = battleStateString ? JSON.parse(battleStateString) : null;\n\n  return (\n    <>\n      <Header />\n      <main className=\"py-12\">\n        <GameContainer>\n          <AdventureClient characterId={characterId} initialBattleState={initialBattleState} />\n        </GameContainer>\n      </main>\n    </>\n  );\n}\n\n\nexport default function AdventurePage({ params }: Props) {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <AdventurePageContent params={params} />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAWA,SAAS,qBAAqB,EAAE,MAAM,EAAS;IAC7C,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,CAAA,GAAA,qMAAA,CAAA,MAAG,AAAD,EAAE;IACnC,MAAM,eAAe,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,oBAAoB,aAAa,GAAG,CAAC;IAC3C,MAAM,qBAAqB,oBAAoB,KAAK,KAAK,CAAC,qBAAqB;IAE/E,qBACE;;0BACE,8OAAC,oIAAA,CAAA,SAAM;;;;;0BACP,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,2IAAA,CAAA,gBAAa;8BACZ,cAAA,8OAAC,6IAAA,CAAA,kBAAe;wBAAC,aAAa;wBAAa,oBAAoB;;;;;;;;;;;;;;;;;;AAKzE;AAGe,SAAS,cAAc,EAAE,MAAM,EAAS;IACrD,qBACE,8OAAC,qMAAA,CAAA,WAAQ;QAAC,wBAAU,8OAAC;sBAAI;;;;;;kBACvB,cAAA,8OAAC;YAAqB,QAAQ;;;;;;;;;;;AAGpC","debugId":null}}]
}