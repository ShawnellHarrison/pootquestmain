{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/class-specific-ai-narration.ts"],"sourcesContent":["'use server';\n/**\n * @fileOverview Generates a tailored story arc and opening narration based on the character class chosen by the player.\n *\n * - generateClassNarration - A function that generates the tailored narration.\n * - ClassNarrationInput - The input type for the generateClassNarration function.\n * - ClassNarrationOutput - The return type for the generateClassNarration function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst ClassNarrationInputSchema = z.object({\n  playerClass: z\n    .string()\n    .describe('The class selected by the player (e.g., rogue, paladin, wizard).'),\n});\nexport type ClassNarrationInput = z.infer<typeof ClassNarrationInputSchema>;\n\nconst ClassNarrationOutputSchema = z.object({\n  storyArc: z.string().describe('A brief summary of the main story arc for the class.'),\n  openingNarration: z.string().describe('The opening narration text for the player.'),\n});\nexport type ClassNarrationOutput = z.infer<typeof ClassNarrationOutputSchema>;\n\nexport async function generateClassNarration(\n  input: ClassNarrationInput\n): Promise<ClassNarrationOutput> {\n  return classNarrationFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'classNarrationPrompt',\n  input: {schema: ClassNarrationInputSchema},\n  output: {schema: ClassNarrationOutputSchema},\n  prompt: `You are the Dungeon Fartmaster, tasked with creating an engaging story for a player character.\n\n  The player has selected the following class: {{{playerClass}}}\n\n  Based on this class, generate a unique story arc and an opening narration to kickstart their adventure in the Tavern of Broken Wind.\n\n  The story arc should be a single sentence summary of the main quest or challenge that the player will face.\n\n  The opening narration should set the scene in the Tavern of Broken Wind and introduce the initial quest or objective. It should be no more than four sentences long and written in a captivating, slightly humorous style.\n\n  Make sure the narration references elements that are specific and relevant to the character class.\n  Follow the example:\n\n  Example:\n  Class: Rogue\n  Story Arc: The Shadowfart Syndicate has stolen the Golden Bean. Only a master of stealth can retrieve it...\n  Opening Narration: You wake in the Tavern of Broken Wind, a shadowy dive where secrets are traded for beans. The barkeep slides you a note: 'The Golden Bean is in the Sewers of Sighs. The guards are heavy, but you... you move like gas through cracks. What's your play, shadow?'`,\n});\n\nconst classNarrationFlow = ai.defineFlow(\n  {\n    name: 'classNarrationFlow',\n    inputSchema: ClassNarrationInputSchema,\n    outputSchema: ClassNarrationOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAyBsB,yBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/branching-narrative-system.ts"],"sourcesContent":["'use server';\n/**\n * @fileOverview This file defines the Genkit flow for the BranchingNarrativeSystem story.\n *\n * - generateNextScenario - A function that generates the next game scenario based on player context.\n * - NarrativeInput - The input type for the generateNextScenario function.\n * - NarrativeOutput - The return type for the generateNextScenario function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst NarrativeInputSchema = z.object({\n  playerClass: z.string().describe('The class of the player character.'),\n  level: z.number().describe('The current level of the player.'),\n  location: z.string().describe('The current location in the game.'),\n  choices: z.array(z.object({\n    id: z.number().describe('The ID of the choice made.'),\n    text: z.string().describe('The text of the choice made.'),\n    tags: z.array(z.string()).describe('Tags associated with the choice.'),\n  })).describe('The choices the player has made so far.'),\n  reputation: z.object({\n    stealth: z.number().describe('The player reputation for stealth.'),\n    combat: z.number().describe('The player reputation for combat.'),\n    diplomacy: z.number().describe('The player reputation for diplomacy.'),\n  }).describe('The player reputation.'),\n  unlockedPaths: z.array(z.string()).describe('The paths unlocked by the player.'),\n  questFlags: z.record(z.string(), z.any()).describe('The quest flags.'),\n});\nexport type NarrativeInput = z.infer<typeof NarrativeInputSchema>;\n\nconst NarrativeOutputSchema = z.object({\n  scenarioText: z.string().describe('The generated scenario text.'),\n  choices: z.array(z.object({\n    id: z.string().describe('The ID of the choice.'),\n    text: z.string().describe('The text of the choice.'),\n  })).describe('The choices available to the player.'),\n});\nexport type NarrativeOutput = z.infer<typeof NarrativeOutputSchema>;\n\nexport async function generateNextScenario(input: NarrativeInput): Promise<NarrativeOutput> {\n  return branchingNarrativeFlow(input);\n}\n\nconst branchingNarrativePrompt = ai.definePrompt({\n  name: 'branchingNarrativePrompt',\n  input: {schema: NarrativeInputSchema},\n  output: {schema: NarrativeOutputSchema},\n  prompt: `You are a dungeon master generating the next part of a text adventure game.\n\n  The player is currently a level {{level}} {{playerClass}} in the {{location}}.\n\n  Here's some information about the player:\n  * Current Reputation: Stealth: {{reputation.stealth}}, Combat: {{reputation.combat}}, Diplomacy: {{reputation.diplomacy}}\n  * Unlocked Paths: {{unlockedPaths}}\n  * Quest Flags: {{questFlags}}\n  * Previous Choices:\n  {{#each choices}}\n  - {{this.text}} (Tags: {{this.tags}})\n  {{/each}}\n\n  Generate the next scenario, offering the player 3 distinct choices. Each choice should have a unique ID, starting with A, and a clear text description of the action the player will take.\n\n  The scenario and the choices should be affected by the player's class, reputation, and previous choices. For example, a player with high stealth might have a stealth-based option available. A paladin might be presented with more morally driven choices.\n\n  Make it so that this scenario involves a decision regarding the Goblin Chief. The output MUST conform to the schema.\n\n  Here's an example of the output format you should follow:\n  {\n    \"scenarioText\": \"You enter the throne room. The Goblin Chief sees you and... lowers his weapon. \\'You spared my scout. Why?\\' His eyes gleam with cunning. This could go many ways...\",\n    \"choices\": [\n      {\n        \"id\": \"A\",\n        \"text\": \"I'm here to end this.\" \n      },\n      {\n        \"id\": \"B\",\n        \"text\": \"I seek the Golden Bean, not war.\"\n      },\n      {\n        \"id\": \"C\",\n        \"text\": \"I work for someone bigger than both of us.\"\n      }\n    ]\n  }\n  `,\n});\n\nconst branchingNarrativeFlow = ai.defineFlow(\n  {\n    name: 'branchingNarrativeFlow',\n    inputSchema: NarrativeInputSchema,\n    outputSchema: NarrativeOutputSchema,\n  },\n  async input => {\n    const {output} = await branchingNarrativePrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAwCsB,uBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI/B,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,8OAAC,qKAAA,CAAA,OAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG,qKAAA,CAAA,OAAuB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 293, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/game/AdventureClient.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport {\n  generateClassNarration,\n  ClassNarrationOutput,\n} from \"@/ai/flows/class-specific-ai-narration\";\nimport {\n  generateNextScenario,\n  NarrativeInput,\n  NarrativeOutput,\n} from \"@/ai/flows/branching-narrative-system\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Swords, BookOpen, Forward } from \"lucide-react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport Link from \"next/link\";\nimport { Separator } from \"@/components/ui/separator\";\n\ninterface AdventureClientProps {\n  playerClass: string;\n}\n\ntype GameState =\n  | \"loading\"\n  | \"intro\"\n  | \"generating_scenario\"\n  | \"choices\"\n  | \"encounter\"\n  | \"error\";\n\n// Represents the full game context that evolves over time\ninterface GameContext extends NarrativeInput {}\n\nexport function AdventureClient({ playerClass }: AdventureClientProps) {\n  const [gameState, setGameState] = useState<GameState>(\"loading\");\n  const [narration, setNarration] = useState<ClassNarrationOutput | null>(null);\n  const [scenario, setScenario] = useState<NarrativeOutput | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [gameContext, setGameContext] = useState<GameContext>({\n    playerClass: playerClass,\n    level: 1,\n    location: \"Tavern of Broken Wind\",\n    choices: [],\n    reputation: {\n      stealth: 10,\n      combat: 10,\n      diplomacy: 10,\n    },\n    unlockedPaths: [],\n    questFlags: {},\n  });\n\n  useEffect(() => {\n    async function getInitialNarration() {\n      try {\n        setGameState(\"loading\");\n        const result = await generateClassNarration({ playerClass });\n        if (result) {\n          setNarration(result);\n          setGameState(\"intro\");\n        } else {\n          throw new Error(\n            \"The AI Dungeon Fartmaster is sleeping. No narration received.\"\n          );\n        }\n      } catch (e: any) {\n        setError(e.message || \"An unknown error occurred while contacting the AI.\");\n        setGameState(\"error\");\n      }\n    }\n    getInitialNarration();\n  }, [playerClass]);\n\n  const handleStart = async () => {\n    try {\n      setGameState(\"generating_scenario\");\n      const result = await generateNextScenario(gameContext);\n      if (result) {\n        setScenario(result);\n        setGameState(\"choices\");\n      } else {\n        throw new Error(\"The AI Dungeon Fartmaster is confused. No scenario received.\");\n      }\n    } catch (e: any) {\n      setError(\n        e.message || \"An unknown error occurred while generating the scenario.\"\n      );\n      setGameState(\"error\");\n    }\n  };\n\n  const handleChoice = (choice: { id: string; text: string }) => {\n    // This would update game context and lead to the first encounter\n    console.log(`Player chose: ${choice.text}`);\n    // In a real game, you would update gameContext here based on the choice\n    // e.g., setGameContext(prev => ({ ...prev, choices: [...prev.choices, { id: choice.id, text: choice.text, tags: [] }] }));\n    setGameState(\"encounter\");\n  };\n\n  const renderContent = () => {\n    switch (gameState) {\n      case \"loading\":\n        return (\n          <div className=\"flex flex-col items-center justify-center text-center\">\n            <Loader2 className=\"h-16 w-16 animate-spin text-primary mb-4\" />\n            <p className=\"text-xl text-muted-foreground\">\n              The AI Dungeon Fartmaster is brewing your fate...\n            </p>\n          </div>\n        );\n      case \"error\":\n        return (\n          <Alert variant=\"destructive\">\n            <AlertTitle>AI Error</AlertTitle>\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        );\n      case \"intro\":\n        return (\n          narration && (\n            <div className=\"space-y-6 text-center\">\n              <div className=\"p-4 bg-muted rounded-lg\">\n                <h3 className=\"font-headline text-lg text-accent flex items-center justify-center gap-2\">\n                  <BookOpen /> Your Story Arc\n                </h3>\n                <p className=\"text-muted-foreground italic mt-2\">\n                  &quot;{narration.storyArc}&quot;\n                </p>\n              </div>\n              <p className=\"text-lg leading-relaxed whitespace-pre-wrap\">\n                {narration.openingNarration}\n              </p>\n              <Button onClick={handleStart} size=\"lg\">\n                What do you do? <Forward className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </div>\n          )\n        );\n      case \"generating_scenario\":\n        return (\n          <div className=\"flex flex-col items-center justify-center text-center\">\n            <Loader2 className=\"h-16 w-16 animate-spin text-primary mb-4\" />\n            <p className=\"text-xl text-muted-foreground\">\n              The story unfolds...\n            </p>\n          </div>\n        );\n      case \"choices\":\n        return (\n          scenario && (\n            <div className=\"space-y-4\">\n              <p className=\"text-center text-lg leading-relaxed whitespace-pre-wrap mb-6\">\n                {scenario.scenarioText}\n              </p>\n              <Separator />\n              <p className=\"text-center text-lg font-bold pt-4\">What do you do next?</p>\n              {scenario.choices.map((choice) => (\n                <Button\n                  key={choice.id}\n                  onClick={() => handleChoice(choice)}\n                  className=\"w-full justify-start\"\n                  variant=\"secondary\"\n                  size=\"lg\"\n                >\n                  <span className=\"font-bold mr-4\">{choice.id}</span> {choice.text}\n                </Button>\n              ))}\n            </div>\n          )\n        );\n      case \"encounter\":\n        return (\n          <div className=\"text-center space-y-4\">\n            <Separator className=\"my-4\" />\n            <p className=\"text-lg text-amber-400 italic\">\n              You burst through the tavern door into the alley. Three Sewer\n              Goblins block your path, noses twitching. &apos;Fresh meat!&apos;\n              they cackle. Roll for initiative!\n            </p>\n            <Button asChild size=\"lg\">\n              <Link href=\"/battle\">\n                <Swords className=\"mr-2 h-4 w-4\" /> To Battle!\n              </Link>\n            </Button>\n          </div>\n        );\n      default:\n        return null;\n    }\n  };\n\n\n  return (\n    <Card className=\"max-w-3xl mx-auto shadow-lg shadow-primary/10\">\n      <CardHeader>\n        <CardTitle className=\"font-headline text-3xl text-glow\">\n          The Adventure Begins\n        </CardTitle>\n        <CardDescription>\n          You find yourself in the Tavern of Broken Wind...\n        </CardDescription>\n      </CardHeader>\n      <CardContent>{renderContent()}</CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAIA;AAKA;AAOA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAvBA;;;;;;;;;;;AAwCO,SAAS,gBAAgB,EAAE,WAAW,EAAwB;IACnE,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA+B;IACxE,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B;IACjE,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;QAC1D,aAAa;QACb,OAAO;QACP,UAAU;QACV,SAAS,EAAE;QACX,YAAY;YACV,SAAS;YACT,QAAQ;YACR,WAAW;QACb;QACA,eAAe,EAAE;QACjB,YAAY,CAAC;IACf;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,eAAe;YACb,IAAI;gBACF,aAAa;gBACb,MAAM,SAAS,MAAM,CAAA,GAAA,0JAAA,CAAA,yBAAsB,AAAD,EAAE;oBAAE;gBAAY;gBAC1D,IAAI,QAAQ;oBACV,aAAa;oBACb,aAAa;gBACf,OAAO;oBACL,MAAM,IAAI,MACR;gBAEJ;YACF,EAAE,OAAO,GAAQ;gBACf,SAAS,EAAE,OAAO,IAAI;gBACtB,aAAa;YACf;QACF;QACA;IACF,GAAG;QAAC;KAAY;IAEhB,MAAM,cAAc;QAClB,IAAI;YACF,aAAa;YACb,MAAM,SAAS,MAAM,CAAA,GAAA,0JAAA,CAAA,uBAAoB,AAAD,EAAE;YAC1C,IAAI,QAAQ;gBACV,YAAY;gBACZ,aAAa;YACf,OAAO;gBACL,MAAM,IAAI,MAAM;YAClB;QACF,EAAE,OAAO,GAAQ;YACf,SACE,EAAE,OAAO,IAAI;YAEf,aAAa;QACf;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,iEAAiE;QACjE,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,OAAO,IAAI,EAAE;QAC1C,wEAAwE;QACxE,2HAA2H;QAC3H,aAAa;IACf;IAEA,MAAM,gBAAgB;QACpB,OAAQ;YACN,KAAK;gBACH,qBACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,iNAAA,CAAA,UAAO;4BAAC,WAAU;;;;;;sCACnB,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;;;;;;;YAKnD,KAAK;gBACH,qBACE,8OAAC,iIAAA,CAAA,QAAK;oBAAC,SAAQ;;sCACb,8OAAC,iIAAA,CAAA,aAAU;sCAAC;;;;;;sCACZ,8OAAC,iIAAA,CAAA,mBAAgB;sCAAE;;;;;;;;;;;;YAGzB,KAAK;gBACH,OACE,2BACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;;sDACZ,8OAAC,8MAAA,CAAA,WAAQ;;;;;wCAAG;;;;;;;8CAEd,8OAAC;oCAAE,WAAU;;wCAAoC;wCACxC,UAAU,QAAQ;wCAAC;;;;;;;;;;;;;sCAG9B,8OAAC;4BAAE,WAAU;sCACV,UAAU,gBAAgB;;;;;;sCAE7B,8OAAC,kIAAA,CAAA,SAAM;4BAAC,SAAS;4BAAa,MAAK;;gCAAK;8CACtB,8OAAC,wMAAA,CAAA,UAAO;oCAAC,WAAU;;;;;;;;;;;;;;;;;;YAK7C,KAAK;gBACH,qBACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,iNAAA,CAAA,UAAO;4BAAC,WAAU;;;;;;sCACnB,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;;;;;;;YAKnD,KAAK;gBACH,OACE,0BACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAE,WAAU;sCACV,SAAS,YAAY;;;;;;sCAExB,8OAAC,qIAAA,CAAA,YAAS;;;;;sCACV,8OAAC;4BAAE,WAAU;sCAAqC;;;;;;wBACjD,SAAS,OAAO,CAAC,GAAG,CAAC,CAAC,uBACrB,8OAAC,kIAAA,CAAA,SAAM;gCAEL,SAAS,IAAM,aAAa;gCAC5B,WAAU;gCACV,SAAQ;gCACR,MAAK;;kDAEL,8OAAC;wCAAK,WAAU;kDAAkB,OAAO,EAAE;;;;;;oCAAQ;oCAAE,OAAO,IAAI;;+BAN3D,OAAO,EAAE;;;;;;;;;;;YAY1B,KAAK;gBACH,qBACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,qIAAA,CAAA,YAAS;4BAAC,WAAU;;;;;;sCACrB,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;sCAK7C,8OAAC,kIAAA,CAAA,SAAM;4BAAC,OAAO;4BAAC,MAAK;sCACnB,cAAA,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAK;;kDACT,8OAAC,sMAAA,CAAA,SAAM;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;;;;;;;YAK7C;gBACE,OAAO;QACX;IACF;IAGA,qBACE,8OAAC,gIAAA,CAAA,OAAI;QAAC,WAAU;;0BACd,8OAAC,gIAAA,CAAA,aAAU;;kCACT,8OAAC,gIAAA,CAAA,YAAS;wBAAC,WAAU;kCAAmC;;;;;;kCAGxD,8OAAC,gIAAA,CAAA,kBAAe;kCAAC;;;;;;;;;;;;0BAInB,8OAAC,gIAAA,CAAA,cAAW;0BAAE;;;;;;;;;;;;AAGpB","debugId":null}}]
}